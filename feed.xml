<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://bepuca.dev/feed.xml" rel="self" type="application/atom+xml" /><link href="https://bepuca.dev/" rel="alternate" type="text/html" /><updated>2020-08-14T01:43:05-05:00</updated><id>https://bepuca.dev/feed.xml</id><title type="html">Bernat Puig Camps</title><entry><title type="html">KVN, Margaret &amp;amp; bingo - Part 3</title><link href="https://bepuca.dev/machine%20learning/2020/06/13/kvn-part-3.html" rel="alternate" type="text/html" title="KVN, Margaret &amp; bingo - Part 3" /><published>2020-06-13T00:00:00-05:00</published><updated>2020-06-13T00:00:00-05:00</updated><id>https://bepuca.dev/machine%20learning/2020/06/13/kvn-part-3</id><content type="html" xml:base="https://bepuca.dev/machine%20learning/2020/06/13/kvn-part-3.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-06-13-kvn-part-3.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In &lt;a href=&quot;https://bepuca.dev/machine%20learning/2020/05/24/kvn-part-1.html&quot;&gt;Part 1&lt;/a&gt;, we defined what we are trying to achieve (KVN whispering Margaret the drawn numbers) and what our proposed solution (a Neural Network).&lt;/p&gt;
&lt;p&gt;In &lt;a href=&quot;https://bepuca.dev/machine%20learning/2020/06/04/kvn-part-2.html&quot;&gt;Part 2&lt;/a&gt;, we introduced the key concepts for KVN to be able to learn anything at all: loss functions, gradient descent and backpropagation.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now it is time to start building the system we want to implement into KVN! To do so, we will use the &lt;strong&gt;Keras&lt;/strong&gt; Python library. This library is specially designed to ease the creation and implementation of neural networks. Most of the things discussed above are already implemented in the library's methods. Let's start by loaing everything we will need.
&lt;div class=&quot;flash flash-warn&quot;&gt;
    &lt;svg class=&quot;octicon octicon-zap&quot; viewBox=&quot;0 0 10 16&quot; version=&quot;1.1&quot; width=&quot;10&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M10 7H6l3-7-9 9h4l-3 7 9-9z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Important: &lt;/strong&gt;Even though we will use Python to implement the concepts, I aim to explain them in a way everyone can get the gist.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Load-the-data&quot;&gt;Load the data&lt;a class=&quot;anchor-link&quot; href=&quot;#Load-the-data&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;First of all, we need some examples for KVN to learn. Recall that we intend to make KVN learn by showing him examples of handwritten digits and telling him what number they represent. The set of examples used for learning are called the &lt;strong&gt;training set&lt;/strong&gt;. Moreover, we also need some other examples that we can show KVN to evaluate him before the big night so we are sure he will deliver. These examples are called the &lt;strong&gt;test set&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Therefore, we need images of handwritten digits that we can show KVN so he can start learning. There is an extensively used public dataset called the &lt;a href=&quot;http://yann.lecun.com/exdb/mnist/&quot;&gt;MNIST&lt;/a&gt; database of handwritten digits. This dataset contains a training set of 60000 examples and a test set of 10000 examples. Luckily for us, this dataset is already implemented in the Keras library so we can directly use it!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;X_train original shape&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;y_train original shape&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;X_train original shape (60000, 28, 28)
y_train original shape (60000,)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As we can see, the training input set &lt;em&gt;X_train&lt;/em&gt; contains 60000 greyscale images of size 28x28 px. The training label set &lt;em&gt;y_train&lt;/em&gt; contains 60000 labels corresponding to each image. Let's look at some of the samples:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Plot some MNIST examples.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;131&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;gray_r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Digit: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdAAAAClCAYAAADsxazGAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAAP7UlEQVR4nO3da4xU1ZrG8WeJyv2igoabzaiEi3pALqIwRxDxGlGIZmAiCBKcjjdMhMELztgRdDjoMVHBKDoZQYWREJABPUYlImNAQbRBOREYjygMggc7wEEMCL3mQzeZ3vvd9mV1Vdeurv8v6Q/vw+pdq2RZL7tq1d7Oey8AAFA3p+R6AgAA5CMaKAAAAWigAAAEoIECABCABgoAQAAaKAAAAQq+gTrnXnTO/UumxwLVYd0hF1h3meUa8/dAnXM7JZ0j6bikE5L+LGmhpPne+/J6HnuYpNe9913q8DslkmZIOlol/p33/i/1mQvSJYXrzkmaLWlyZfSKpId8Y/6fvwClbd1V+d3TJW2W1Drk99OsEM5AR3rvW0sqUsWLyIOS/j2H83nTe9+qyg/Ns3FK07r7J0mjJPWR9DtJIyUV52guyK40rbuT/lnSX3M8h6wohAYqSfLeH/Te/5ekMZImOOcukiTn3KvOuVknxznnpjvnfnDO7XHOTXbOeefcBVXHOudaSvqTpE7OucOVP51y8byQbilZdxMk/dF7v9t7/7+S/ihpYoafKlIkJetOzrm/kzRO0r9l+jmmQcE00JO89xsk7Zb0+/ifOeeuk/SApBGSLpA07DeO8bOk6yXtqXImucc59/fOuQM1TGGkc67MObfVOXdXfZ4L8keO192FqngL7aTNlRkauRS83j0v6RFJv4Q/i/QquAZaaY+kMxPyf5D0H977rd77I5JK6nJQ7/3H3vt21QxZIqmXpA6S7pT0r865f6zLYyCv5WrdtZJ0sEp9UFKrys9G0fjlZN0550ZLauK9X16X4+aTQm2gnSWVJeSdJO2qUu9KGBPMe/9n7/0e7/0J7/06Sc9KujWTj4FUy8m6k3RYUpsqdRtJh9lEVDAafN1Vvu07R9KUTB0zjQqugTrnBqpiQX2c8Mc/SKq6S6xrNYfKxIuPl8RZQAHI8brbqooNRCf1qczQyOVw3XWX1E3Sfzvn9kpaJqmjc26vc65bHY+VWgXTQJ1zbZxzN0r6T1Vsx/4yYdgSSXc453o551pIqu47UPskneWca1uHOdzsnDvDVbhUFf86W1GHp4E8k4Z1p4qvMjzgnOtcufljqqRX6/D7yDMpWHdfqaIh9638mVx5jL7K/DssOVMIDXSlc+5vqvhLmyHpGUl3JA303v9J0nOSPpT0P5I+qfyjowljv5a0WNJfnHMHnHOdnHO/d84drmYuYyuP+zdVvKj9wXu/IOxpIeXStO5ekrRS0peqeGF7uzJD45OKdee9P+6933vyRxVvIZdX1ifq+RxTo1FfSKG+nHO9VPGC09R7fzzX80FhYN0hF1h3dVcIZ6B14pwb7Zxr6pw7Q9IfJK1kMSHbWHfIBdZd/dBArWJJP0r6RhWXw+K7mmgIrDvkAuuuHngLFwCAAJyBAgAQgAYKAECAU+syuH379r5bt25Zmgryyc6dO7V///6sXwSCNYeqNm3atN973yHbj8O6w0nVvdbVqYF269ZNn332WWZmhbw2YMCABnkc1hyqcs591xCPw7rDSdW91vEWLgAAAWigAAAEoIECABCABgoAQAAaKAAAAWigAAAEoIECABCABgoAQAAaKAAAAWigAAAEoIECABCABgoAQAAaKAAAAWigAAAEoIECABCABgoAQIA63VAbQHps2rQpUs+dO9eMWbBggckmTJhgsvvuuy9S9+vXr56zAxo/zkABAAhAAwUAIAANFACAADRQAAACsIko5sSJE5H64MGDQcdJ2tBx5MgRk23bts1k8+bNi9TTpk0zYxYvXmyyZs2aReqHHnrIjHnsscfsZJF6paWlJhsxYkSkPnTokBnjnDPZwoULTbZixYpIXVZWVtcpAvW2evVqk912220m++ijjyJ1jx49sjan6nAGCgBAABooAAABaKAAAARoFJ+Bfv/995H62LFjZsy6detM9vHHH5vswIEDkXrp0qX1nF31unbtarL4l9qXL19uxrRu3dpkffr0idRDhw6t5+yQCxs2bDDZLbfcYrL45/NJn3e2adPGZKeffrrJ9u/fH6nXr19vxvTv379Wx0LU2rVrTfbTTz9F6tGjRzfUdFJt48aNJhswYEAOZlI7nIECABCABgoAQAAaKAAAAWigAAAEyLtNRF988YXJhg8fHqlDL36QbU2aNDHZrFmzTNayZctInfRF4k6dOpnsjDPOiNS5+nIxflvSxTQ+//zzSD1u3DgzZs+ePUGP1717d5NNnz7dZGPGjInUQ4YMMWOS1uojjzwSNK9CsmbNGpPt2LEjUhfqJqLy8vJI/e2335ox8U2ikuS9z9qc6oIzUAAAAtBAAQAIQAMFACAADRQAgAB5t4moqKjIZO3bt4/U2d5ENGjQIJPFN/B8+OGHZkzSVVvGjx+fuYkh9YqLi022aNGirD3epk2bTHb48GGTxa9albTx5csvv8zYvArJggULTDZ48OAczCR9fvjhh0g9f/58MybpNbJnz55Zm1NdcAYKAEAAGigAAAFooAAABMi7z0DPPPNMkz311FOReuXKlWbMJZdcYrIpU6bU+Hh9+/Y12QcffGCy+MUPvvrqKzPmueeeq/Hx0Hgkff64atUqk9XmS+HDhg0z2Y033hipp02bZsYkXXAj6f+F2nyGn5Yvr+eb+MUC8P8mT55c45iki4GkBWegAAAEoIECABCABgoAQAAaKAAAAfJuE1GSUaNGRer43VkkqXXr1ibbsmWLyV555ZVInbQxI75hKMlFF11ksqQvCaNxKC0tNdmIESNMdujQIZM55yL1DTfcYMYsXrzYZPGLHTzxxBNmTNImjQ4dOpisT58+1c5Jkt5++22Txe8k069fPzOmkCS9puzbty8HM8kPBw4cqHHM1Vdf3QAzCcMZKAAAAWigAAAEoIECABCABgoAQIBGsYkork2bNrUa17Zt2xrHxDcVSdLYsWNNdsop/FukkGzfvj1Sz5kzx4xJuitQ0gaejh07RuoJEyaYMa1atTJZ/EpE8TrTjhw5YrKnn346UmfzzjL54J133jHZL7/8koOZpE/SZqqdO3fW+HudO3fOwmwyg1d9AAAC0EABAAhAAwUAIAANFACAAI1yE1FtlZSUmCx+C6r41V6k5NuZXXPNNZmaFlLm6NGjJotfoSrpKj1Jm9kWLlxosgEDBkTqfNp0smvXrlxPIVW2bdtWq3EXXnhhlmeSPklXddu7d2+k7tGjhxmTdBW5tOAMFACAADRQAAAC0EABAAhQ0J+BJt1V5eWXX47USXeXuPPOO0125ZVXRur451qSdM8995gs6a4XSJf4HUek5M8841asWGGyoUOHZmROyG8DBw7M9RSCxe8o9O6775oxr7/+usnee++9Go/96KOPmqxdu3Z1mF3D4gwUAIAANFAAAALQQAEACEADBQAgQEFvIkpy/vnnR+pXX33VjLnjjjtMFv+CfNIX5n/++WeT3X777SaL350DufXAAw+YzHsfqYcNG2bG5POGofjzq+84RJWVlWXkOJs3bzZZeXm5yVavXm2y3bt3R+pjx46ZMW+88UaNx2/evLkZM2jQIJM1bdrUZL/++mukTtp8mWacgQIAEIAGCgBAABooAAABaKAAAARgE1ENRo8ebbILLrjAZFOnTo3USXdsefjhh0323XffmWzGjBmRunPnzjXOE5mxatUqk5WWlposfgWpm266KWtzyoWkK2QlZX379m2I6eSNpA01Sf/diouLI/WTTz4Z9HhJm4iSNnaddtppJmvRokWk7tWrlxkzadIkk/Xv3z9SJ22gO+ecc0zWpUsXk8XvPNSzZ08zJs04AwUAIAANFACAADRQAAAC8BlogIsvvthkS5YsidQrV640YyZOnGiyF1980WQ7duyI1O+//34dZ4hQ8c9kpOQvmJ999tmResyYMVmbU6YdPXrUZCUlJTX+3lVXXWWy2bNnZ2JKjcYLL7xgsqKiIpOtW7cuI4937rnnmuzmm282We/evU122WWXZWQOSebPn2+yH3/80WTnnXde1ubQEDgDBQAgAA0UAIAANFAAAALQQAEACMAmogxp165dpB4/frwZM3nyZJPF70YgSWvXro3Ua9asMWOSvryMhtOsWbNIndY76CRtGJo1a5bJ5syZE6m7du1qxsQvFiJJrVq1qsfsCsODDz6Y6yk0uKS7vyS59dZbszyT7OIMFACAADRQAAAC0EABAAhAAwUAIACbiAJs2bLFZEuXLo3UGzduNGOSNgwliV815IorrqjD7NAQ0nj3laS7xsQ3B0nSm2++abL41WuWLVuWuYkBv2HUqFG5nkK9cAYKAEAAGigAAAFooAAABKCBAgAQgE1EMdu2bYvUzz//vBmTtMFi7969QY936qn2ryB+VZtTTuHfOQ3Fe1+r7K233orUzz77bNbm9FueeeaZSD1z5kwz5uDBgyYbN26cyRYuXJi5iQEFgldmAAAC0EABAAhAAwUAIEDBfAaa9BnlokWLTDZ37txIvXPnzozNYeDAgSabMWOGydL4Jf1C4ZyrVRZfT1OmTDFjJk2aZLKzzjrLZJ988kmkfu2118yYzZs3m2zXrl2RuqioyIy57rrrTHb33XebDMiFHTt2ROrLL788RzMJwxkoAAABaKAAAASggQIAEIAGCgBAgEaxiWjfvn2ReuvWrWbMvffea7Kvv/46Y3MYNGhQpJ4+fboZE7/jhcRFEvLV8ePHI/W8efPMmPgdeiSpbdu2Jtu+fXvQHAYPHhyphw8fbsY8/vjjQccGGkJ5eXmup1AvvHoDABCABgoAQAAaKAAAAWigAAAESPUmorKyMpMVFxebrLS0NFJ/8803GZvDkCFDTDZ16lSTXXvttZG6efPmGZsDGk7SlVAuvfRSk23YsKHGYyVd/Sq+4S1J+/btTTZ27FiT5eIOMEAmrV+/PlJPnDgxNxMJxBkoAAABaKAAAASggQIAECBnn4F++umnJpszZ06k3rhxoxmze/fujM2hRYsWJovfVSPpbiktW7bM2ByQLl26dDHZsmXLTPbSSy9F6pkzZwY/5v333x+p77rrLjOme/fuwccHkB2cgQIAEIAGCgBAABooAAABaKAAAATI2Sai5cuX1yqrjd69e0fqkSNHmjFNmjQx2bRp00zWrl27oDmg8erYsaPJSkpKqq2BQnb99debbMmSJTmYSXZxBgoAQAAaKAAAAWigAAAEoIECABAgZ5uIZs+eXasMAJBfku6qkm93WqkNzkABAAhAAwUAIAANFACAADRQAAAC0EABAAhAAwUAIAANFACAADRQAAAC0EABAAhAAwUAIAANFACAADRQAAAC0EABAAjgvPe1H+zcXyV9l73pII8Uee87ZPtBWHOIYd2hof3mmqtTAwUAABV4CxcAgAA0UAAAAtBAAQAIQAMFACAADRQAgAA0UAAAAtBAAQAIQAMFACAADRQAgAD/B2O5weZlR/C1AAAAAElFTkSuQmCC
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Format-the-data&quot;&gt;Format the data&lt;a class=&quot;anchor-link&quot; href=&quot;#Format-the-data&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;As expected, these images are just what we need for KVN to learn to assist Margaret! Now, in order to use the images in the Keras implementation of the system, they have to be formatted in a particular manner (defined by the Keras library)::&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Each pixel value goes from 0 to 255, but inputs need to be between 0 and 1. &lt;/li&gt;
&lt;li&gt;&lt;p&gt;The inputs must be vectors, not matrices.&lt;/p&gt;
&lt;p&gt;28x28 px -&amp;gt; 784x1 px&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;There are ten categories which correspond to digits from $0$ to $9$.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Format the data shape.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Change data type.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float32&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float32&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float32&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float32&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Normalize inputs to 0-1 interval.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Training matrix shape&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Testing matrix shape&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Training matrix shape (60000, 784)
Testing matrix shape (10000, 784)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Build-the-neural-network&quot;&gt;Build the neural network&lt;a class=&quot;anchor-link&quot; href=&quot;#Build-the-neural-network&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now that we have the data, we need to &lt;strong&gt;build&lt;/strong&gt; the system that we will implement to KVN, we need to build the neural network! So far, the only network that we have seen had one (dummy) input layer, one hidden layer and one output layer. There are different types of layers. The one that is fully connected to the previous and the next layer (as the ones we have seen) is called &lt;strong&gt;Dense&lt;/strong&gt; in Keras. For now, we will stick to this simple &lt;strong&gt;architechture&lt;/strong&gt; (i.e. network structure) and see if it works. That is, our neural network will be constituted by:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;An input layer with $784$ inputs (one per pixel).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;A hidden Dense layer with $n=30$ neurons.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Activation function: sigmoid&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;An output Dense layer with $n=10$ neurons.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Activation function: sigmoid&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The choice of $n=30$ neurons in the hidden layer is rather arbitrary. Nonetheless, the number of neurons on the output layer is directly related to the number of categories we want for KVN to learn. Since we have $10$ categories (digits), we need $10$ neurons. The idea is that KVN's guess will be related to the neuron that has the higher activation. If the neuron corresponding to the digit 3 is the one with the higher activation, KVN is saying: &lt;em&gt;&quot;A 3!&quot;&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Keras allows us to build our neural network in a very intuitive way. We generate what is called a &lt;em&gt;Sequential&lt;/em&gt; model that basically lets us to add layers sequentially. When we add layers, there are ways to initialize the weights and biases (i.e. the parameter set) with different distributions. Nonetheless, we won't focus on this. Despite that, know that the initialization can influence the learning procedure. This makes sense since the initialization determines where in the mountain we start our downhill!&lt;/p&gt;
&lt;p&gt;Enough chit chat, let's build KVN's system!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Define KVN&amp;#39;s system.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kvn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;KVN_system&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Add the hidden layer, a Dense layer with 30 neurons.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# The first layer also requires specification of input dimensions.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#Â Specify the activation function of the neurons too.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kvn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hidden&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Add the output layer, a Dense layer with 10 neurons (1 neuron per category).&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kvn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sigmoid&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;output&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Save the initial weights and biases.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kvn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save_weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;kvn_init_weights.h5&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Keras also allows us to check that we built the system we want. Here's how:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kvn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Model: &amp;#34;KVN_system&amp;#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
hidden (Dense)               (None, 30)                23550     
_________________________________________________________________
output (Dense)               (None, 10)                310       
=================================================================
Total params: 23,860
Trainable params: 23,860
Non-trainable params: 0
_________________________________________________________________
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Insert-system-into-KVN&quot;&gt;Insert system into KVN&lt;a class=&quot;anchor-link&quot; href=&quot;#Insert-system-into-KVN&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now that we have defined our system, we plug it into KVN. In actual terms, we &lt;strong&gt;compile&lt;/strong&gt; the model (we won't delve into that either). The only thing that we need to know is that we need to specify the loss function (measure of how wrong KVN is), the optimizer (KVN's learning method) we want to use in the system and which metrics we want to get (the accuracy of KVN's predictions).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Compile the model.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kvn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Loss function (wrongness meter). &lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sparse_categorical_crossentropy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Optimizer (learning method).&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sgd&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Result evaluation.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;KVN,-learn!&quot;&gt;KVN, learn!&lt;a class=&quot;anchor-link&quot; href=&quot;#KVN,-learn!&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now that we have plugged the system into KVN it is time to start showing him the images of the numbers. 60000 of them. This phase is usually called the model &lt;strong&gt;fit&lt;/strong&gt; because we are fitting all parameters to minimize the cost function. The &lt;strong&gt;validation set&lt;/strong&gt; specified here answers to a similar idea as the test set. We have a set of examples to validate how KVN's is doing during the learning phase. 
&lt;div class=&quot;flash flash-success&quot;&gt;
    &lt;svg class=&quot;octicon octicon-checklist&quot; viewBox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; width=&quot;16&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M16 8.5l-6 6-3-3L8.5 10l1.5 1.5L14.5 7 16 8.5zM5.7 12.2l.8.8H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h7c.55 0 1 .45 1 1v6.5l-.8-.8c-.39-.39-1.03-.39-1.42 0L5.7 10.8a.996.996 0 000 1.41v-.01zM4 4h5V3H4v1zm0 2h5V5H4v1zm0 2h3V7H4v1zM3 9H2v1h1V9zm0-2H2v1h1V7zm0-2H2v1h1V5zm0-2H2v1h1V3z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Tip: &lt;/strong&gt;For proper development, we would want a validation set &lt;em&gt;and&lt;/em&gt; a test set. Validation sets are used to try different strategies and asses which one is best during training. The test set should only be used at the end to provide an idea on how good KVN will work in the real situation.
&lt;/div&gt;
Let's learn!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Number of training examples in each mini-batch.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;# Number of epochs.&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fit the model and store information in history.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kvn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;KVN,-test-time!&quot;&gt;KVN, test time!&lt;a class=&quot;anchor-link&quot; href=&quot;#KVN,-test-time!&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;After this training session, KVN should have learned something. Now we want to see what has he learnt. To do so, let's evaluate KVN. Let's show him the test images (which he didn't use to learn although we already used them to see how he was doing) and see how good is he at identifying the digit present.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Evaluate the performance of the system with the test set.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kvn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Scores contain the specified metrics.&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Test loss:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;# Loss function by default.&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Test accuracy:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Accuracy as asked.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Test loss: 0.2650674283504486
Test accuracy: 0.9253000020980835
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Damn, KVN! This is a remarkably good result! An accuracy of over $0.90$ means that KVN got the digit right more than $90 \%$ of the time. This is quite a feature!&lt;/p&gt;
&lt;p&gt;Let's check some of the KVN's good guesses and some of the KVN's bad guesses to get a flavor of what he has learned.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Get the predicted class for each sample in X_test.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predicted_classes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kvn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Check which are the good guesses and the bad guesses.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;correct_indexes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nonzero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predicted_classes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;incorrect_indexes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nonzero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predicted_classes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# And see some examples.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Good guesses (predictions).&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;correct_indexes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;131&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;gray_r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;KVN&amp;#39;s guess: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicted_classes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, digit &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tight_layout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# Bad guesses (predictions).&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;  
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;incorrect_indexes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;131&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;gray_r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;KVN&amp;#39;s guess: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicted_classes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, digit &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tight_layout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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AAAgKooNAAAQFcUGAACIimIDAABERbEBAACiotgAAABRUWwAAICoKDYAAEBUFBsAACAqig0AABAVxQYAAIiqSn+IDQCAuuz111/3sptvvtnLhg8f7mXnnnuulzVt2rR2OlbPMbMBAACiotgAAABRUWwAAICoKDYAAEBUFBsAACAqvo1SJD7//PNgvnr16mrvs6yszMsmTpzoZd27d/eyzp07B/d5wgknVLs/KJzNmzcH82bNmnlZgwa8B0H9de+993rZwoULvWzBggVeduGFF3rZmDFjvCz0mlrqeFUBAABRUWwAAICoKDYAAEBUFBsAACAqFohG9sILL3jZnDlzvGz+/PnB7VeuXFntY3fp0sXLVq1a5WW7du3KvM89e/ZUuz8onB/84AfBPHSq5SuuuMLLQqdprqs2bNjgZa1atQq2bdiQl8j65tRTT/WyWbNmednu3bu9bObMmV726quvetn48eO9bOjQocH+lMoYY2YDAABERbEBAACiotgAAABRUWwAAICoSmNlSg199NFHXjZ58mQve/jhh71s586dXuacq52O7cOKFSv2y3FQ/E466aRgfvfdd3vZ6aefHrs7BTVp0iQvCy0GlKR77rkndnewn11//fVe9tVXX3lZaJysXbvWyzZt2uRlw4YN87J8i/1D/enQoUOwbV3GzAYAAIiKYgMAAERFsQEAAKKi2AAAAFGxQDSDNWvWeFlo8VAhHXPMMV7GnznGXp06dSp0Fwri5Zdf9rLQnxjPdxZdFoiWhhtuuMHLOnbs6GXr1q3zstAXCB544AEvmzBhQvDY27dvz7R9XcfMBgAAiIpiAwAAREWxAQAAoqLYAAAAUdW7BaKhs7mFFnP26dMnuP2gQYO87KCDDvKy5s2be9khhxziZaHFPwMHDvSyfIs5e/Xq5WU9evTwssaNG3tZ6M+HozTVxwVnWcybN8/LQotB851hFaVryJAhmdqFzhId+v2Qb4HolClTvKx9+/ZeNnr06Ez9KVbMbAAAgKgoNgAAQFQUGwAAICqKDQAAEFWdXiC6Y8cOLxswYICXvf322142a9aszMfp3bu3ly1dutTLysvLvWz16tVeFjozXYMG1H2oHe+++66Xhf40dil45ZVXMrUbO3Zs5J6gvgotzh8/fryXhZ6XkvT888972dy5c73spptu8rJGjRpl6WJR4DccAACIimIDAABERbEBAACiotgAAABR1ZkFol9++aWXXXzxxV4WWgw6atQoL+vfv3+N+hNaDBpy5JFH1ug4QFUtWrTIy7Zs2ZJ5+7p65tnQmUF3797tZaEFfX379o3SJ2CvadOmBfPQ8y30HN66dauXtWnTpuYd20+Y2QAAAFFRbAAAgKgoNgAAQFQUGwAAICqKDQAAEFVRfhtl+/btXnbHHXd42Zw5c7wstDp35MiRXtakSZNq9g4oHqHnyoQJEzJvP3jwYC+76qqratSnQpk9e7aXLVu2zMtCt69FixZR+gTsle/bKKWCmQ0AABAVxQYAAIiKYgMAAERFsQEAAKIqygWis2bN8rI777zTy8rKyrxs4cKFXta8efPa6RhQZEaMGOFlK1asyLz92LFja7M7BfXoo48WugsoQTt37vSy22+/3cuqsnB74MCBXtayZcuqdazIMLMBAACiotgAAABRUWwAAICoKDYAAEBURblA9LXXXsvUrkePHl7WsWPH2u4OUBSef/55L5s+fXqmbcvLy4N5ly5datKlgtmyZYuXrV+/vgA9QTG47rrrvOz+++8Ptu3QoYOXnX/++V4WWpDZqFEjLwudyfrNN98MHjuka9euXvbII494WcOGRfnrOjNmNgAAQFQUGwAAICqKDQAAEBXFBgAAiKooV5zMmDEjU7sXX3zRy2699VYv+973vudlocWlQLHYunWrl912221eFlooGfLcc88F84MPPrhqHSsSH3/8sZeF/px8yOWXX17b3UGBhc7iaWbBtmvXrvWyKVOmeJlzLvM+K2rXrp2XXX311cG2Q4cO9bLQIta6jpkNAAAQFcUGAACIimIDAABERbEBAACiKsoFohs3bvSy0MKcXbt2eVlogej48eO9bNiwYcFj9+rVy8s+/fRTLzv66KO9rFu3bsF9VrR8+XIv6927d7AtZ0QtTRs2bPCyxYsXZ9p28ODBXnbcccfVuE/1xWGHHVboLqCWhc4WGnoeSOHn0bRp07ws9BzcvHlzpv5cdNFFXnbLLbdk2ra+YmYDAABERbEBAACiotgAAABRUWwAAICoinKB6I033uhlEyZMqPb+vv76ay+bPHlysG2+PLa2bdsG8379+nnZ008/Hbk32J/mzp3rZaNGjcq07be//W0vC43hAw44ILh96CyJO3bsyHTskAMPPNDLdu/enXn7pk2belnWszaGhBYJHnXUUdXeH4pT6E+/n3322cG2oXzMmDFeFjqLb+gLCJMmTfKyZ5991stGjhwZ7E+pfAmAmQ0AABAVxQYAAIiKYgMAAERFsQEAAKIqygWid955p5eFzsh2ySWXeFloMdqaNWu8LLRotJBCZ6uTpOnTp3tZ9+7dvazUz05Xl82ePdvL3nrrrUzbhs6ie/vtt2c+duh58OCDD2bevqIePXp42dKlSzNv/9RTT3nZeeed52UvvfRSpv21aNHCy2qy4BSlo1mzZl4W+p3z0EMPeVno9Ty04LSUMLMBAACiotgAAABRUWwAAICoKDYAAEBUFBsAACCqovw2SujUyieffLKXffDBB5n297vf/c7L8p1Cedy4cV72xhtvZDpODKHTSS9ZsqQAPUEsM2fOrPa2q1ev9rJCnXJfkrZv3+5lRx55pJeFVvpL4dX+PXv29LKNGzdm6s/w4cMztUNxGj9+vJf17ds3U7a/7Nmzx8tCr9uljpkNAAAQFcUGAACIimIDAABERbEBAACiKsoForXtzDPPzNx22bJlXhZaIHrggQd62dChQ73syiuv9LKJEyd62dSpU7N2EfXM6NGjvezaa6/NtG1ZWZmXtWvXzsuaNm2auT9nnHGGl4UWaIeccsopXvbFF194WevWrYPbL1iwwMt+9atfednixYu97MQTT/Syzp07B4+D4jNjxgwvu/vuu70s9DpbUx9++KGX3XfffV42b948Lwv9yQBOie9jZgMAAERFsQEAAKKi2AAAAFFRbAAAgKhKYoFoVZx11lleNmrUKC8LnYH04Ycf9rKVK1d62fz586vXuVSHDh1qtD2Ky7Bhw7ysV69embZt3769l7Vq1crLmjRpUvWO1ZKWLVtmbjtgwAAvmz17dqZte/fu7WXNmzfPfGzsP6Gzbj755JNetmPHDi8LLc7fsGGDl+3cuTN47MceeyxT9sknn3hZaOFnaPH1Nddc42WlvliZmQ0AABAVxQYAAIiKYgMAAERFsQEAAKJigWgFxx57rJcNGTLEy5555plM+wudcS6kYcPwQ3HOOed42V133ZVpn6gbQo991jN2loKxY8d62YgRI7wstFgWxWnTpk1eNmfOnEzbHn744V4W44yd/fr187ILLrjAy/r37+9lXbt2rfX+1HXMbAAAgKgoNgAAQFQUGwAAICqKDQAAEBULRCto3Lixl02aNMnLtm3b5mVLlizxsvXr13tZeXm5l1122WXB/owbNy6YA6WiTZs2mTLUHaGz3A4cONDL5s6dW+1j/PSnPw3mBx98sJeFvgTQp0+fah8bPmY2AABAVBQbAAAgKooNAAAQFcUGAACIigWiGbRr187LXnjhBS974oknvGzRokVeFlr02bZt2+p1DgDqmNBZc3/7298WoCfYX5jZAAAAUVFsAACAqCg2AABAVBQbAAAgKhaI1qJLL700UwYAQClhZgMAAERFsQEAAKKi2AAAAFFRbAAAgKgoNgAAQFQUGwAAICqKDQAAEBXFBgAAiIpiAwAAREWxAQAAoqLYAAAAUVFsAACAqCg2AABAVBQbAAAgKooNAAAQFcUGAACIimIDAABERbEBAACiotgAAABRUWwAAICozDmXvbHZRkmfxOsO6rEy51ybQneiKhjvqCHGPEpJpeO9SsUGAABAVfExCgAAiIpiAwAAREWxAQAAoqLYAAAAUVFsAACAqCg2AABAVBQbAAAgKooNAAAQFcUGAACI6v8AT/6MmFnJqTwAAAAASUVORK5CYII=
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Well, as we can see above, KVN got trouble learning to identify digits of rather poor handwritting but correctly identified more standard ones. So, for now, I think we can say that KVN did a good job!&lt;/p&gt;
&lt;p&gt;Okay okay, good compared to what? The most trivial system would be to randomly pick a class. That is, that when we show KVN an image he randomly says a digit. In that case, he will be right, on average, $10 \%$ of the time (because we have $10$ classes). So our system is quite better than the random system! Nonetheless, &lt;em&gt;how good is the accuracy&lt;/em&gt; heavily depends on the problem. If we were trying to identify if a patient has cancer, for instance, this accuracy might still be too low. For the case at hand, that accuracy will absolutely do for good old Margaret.&lt;/p&gt;
&lt;p&gt;KVN got a cookie!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/kvn/kvn_cookie.jpg&quot; alt=&quot;&quot; title=&quot;KVN and his well-deserved cookie.&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Did-we-get-lucky?&quot;&gt;Did we get lucky?&lt;a class=&quot;anchor-link&quot; href=&quot;#Did-we-get-lucky?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;As you might have realized, I made some &lt;em&gt;arbitrary&lt;/em&gt; choices regarding some of the parameters such as the the number of neurons in the hidden layer or the epochs trained. Will KVN always perform that good independently of the choices we make? The short answer is no.&lt;/p&gt;
&lt;p&gt;In the next (and final part), we will discover some of the factors that can dramatically impact the learning capabilities and performance of neural networks. We will talk about hyperparameters and regularization.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://bepuca.dev/machine%20learning/2020/05/24/kvn-part-1.html&quot;&gt;Part 1&lt;/a&gt;: Definition of Neural Networks at the problem at hand. Friendly context introduction.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://bepuca.dev/machine%20learning/2020/06/01/kvn-part-2.html&quot;&gt;Part 2&lt;/a&gt;: The training building blocks: loss functions, gradient descent and backpropagation.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">KVN, Margaret &amp;amp; bingo - Part 2</title><link href="https://bepuca.dev/machine%20learning/2020/06/04/kvn-part-2.html" rel="alternate" type="text/html" title="KVN, Margaret &amp; bingo - Part 2" /><published>2020-06-04T00:00:00-05:00</published><updated>2020-06-04T00:00:00-05:00</updated><id>https://bepuca.dev/machine%20learning/2020/06/04/kvn-part-2</id><content type="html" xml:base="https://bepuca.dev/machine%20learning/2020/06/04/kvn-part-2.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-06-04-kvn-part-2.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In &lt;a href=&quot;https://bepuca.dev/machine%20learning/2020/05/24/kvn-part-1.html&quot;&gt;Part 1&lt;/a&gt;, we defined what we are trying to achieve (KVN whispering Margaret the drawn numbers) and what our proposed solution (a Neural Network).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Learning-time!&quot;&gt;Learning time!&lt;a class=&quot;anchor-link&quot; href=&quot;#Learning-time!&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now we have an idea of what the new system we want to implement to KVN will look like. The problem is we need to be able to train this system. That is, we need a method for KVN to learn to identify the numbers using this system.&lt;/p&gt;
&lt;p&gt;In more mathematical terms, learning means finding the optimal parameter set of weights $w$ and biases $b$ such that, at the end, KVN gets the digit right the maximum possible number of times. This is actually a big optimization problem and the concepts used in smaller problems hold.&lt;/p&gt;
&lt;p&gt;The main idea required so that KVN can learn is that he needs to understand when he is wrong and how wrong he is. Once this is defined, he can learn to be less wrong the next time he tries (i.e. the parameters can be optimized). Ideally, if he tries a lot of times, he will eventually be as right as he can be with the particular system we design for him.&lt;/p&gt;
&lt;h3 id=&quot;Wrongness-meter-(a.k.a-Loss-Function)&quot;&gt;Wrongness meter (a.k.a Loss Function)&lt;a class=&quot;anchor-link&quot; href=&quot;#Wrongness-meter-(a.k.a-Loss-Function)&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;So, how can we define how wrong is KVN? The idea is to define what it is called a &lt;strong&gt;loss function&lt;/strong&gt; or &lt;strong&gt;cost function&lt;/strong&gt; $C$. This function must represent the distance between the truth (i.e. the correct digit) and the system's output (i.e. KVN's guess). That is, how wrong is KVN.&lt;/p&gt;
&lt;p&gt;The two natural conditions that this function has to fulfill is that it has to depend on the output (otherwise it wouldn't make sense) and it has to be strictly positive (we will see in a moment why). Again, as in the activation function case, there are many different cost functions with different properties (but we won't enter into more detail here). Two of the most popular cost functions are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The &lt;strong&gt;quadratic cost function&lt;/strong&gt;:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
$$ C(w,b) = \frac{1}{2n} \sum_i \| o(i) - a(i)\|^2 $$
&lt;/p&gt;
&lt;p&gt;This function represent the mean quadratic distance over all inputs $i$ (all images to learn) between the output corresponding to the input (guess of each image) and the correct answer $a$. It solely depends on the system parameters $w, b$. $n$ is the total number of inputs. This is the traditionally used cost function in optimization (or regression) problems.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The &lt;strong&gt;cross entropy cost function&lt;/strong&gt;:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
$$ C(w,b) = -\frac{1}{n} \sum_i [o\ln{a}+ (1-o)\ln{(1-a)}] $$
&lt;/p&gt;
&lt;p&gt;Notice that in this case, abusing notation, $a,o$ are equivalent to $a(i), o(i)$. This function is designed to solve some of the limitations of the quadratic cost function. In fact, cross-entropy is widely used in problems like the one we are trying to solve.&lt;/p&gt;
&lt;p&gt;Now that KVN have a wrongness meter, how can we he use it to learn anything?&lt;/p&gt;
&lt;h3 id=&quot;The-downhill-bike-(a.k.a.-Gradient-Descent)&quot;&gt;The downhill bike (a.k.a. Gradient Descent)&lt;a class=&quot;anchor-link&quot; href=&quot;#The-downhill-bike-(a.k.a.-Gradient-Descent)&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The typical method to solve optimization problems is what it is called &lt;strong&gt;gradient descent&lt;/strong&gt;. This might sound quite complicated but the main idea is rather simple. To illustrate, let's define an arbitrary cost function that depends only on a single variable $x$. The situation is the following:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define x grid.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;xx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Arbitrary cost function.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;cost_fun&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Compute function shape.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cost_fun&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initial situation&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;121&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zorder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cost_fun&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arrow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Initial situation&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;$x$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;$C(x)$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Final situation&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;122&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zorder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;lime&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Final situation&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;$x$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;$C(x)$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tight_layout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_svg output_subarea &quot;&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;
&amp;lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot;
  &quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&amp;gt;
&lt;!-- Created with matplotlib (https://matplotlib.org/) --&gt;
&lt;svg height=&quot;164.074375pt&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 421.465625 164.074375&quot; width=&quot;421.465625pt&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;
 &lt;defs&gt;
  &lt;style type=&quot;text/css&quot;&gt;
*{stroke-linecap:butt;stroke-linejoin:round;}
  &lt;/style&gt;
 &lt;/defs&gt;
 &lt;g id=&quot;figure_1&quot;&gt;
  &lt;g id=&quot;patch_1&quot;&gt;
   &lt;path d=&quot;M 0 164.074375 
L 421.465625 164.074375 
L 421.465625 0 
L 0 0 
z
&quot; style=&quot;fill:none;&quot; /&gt;
  &lt;/g&gt;
  &lt;g id=&quot;axes_1&quot;&gt;
   &lt;g id=&quot;patch_2&quot;&gt;
    &lt;path d=&quot;M 34.240625 126.518125 
L 203.665625 126.518125 
L 203.665625 22.318125 
L 34.240625 22.318125 
z
&quot; style=&quot;fill:#ffffff;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;line2d_1&quot;&gt;
    &lt;path clip-path=&quot;url(#pb217962a62)&quot; d=&quot;M 41.941761 27.054489 
L 43.497546 36.606879 
L 45.053332 45.487904 
L 46.609117 53.725517 
L 48.164902 61.347122 
L 49.720687 68.379573 
L 51.276472 74.84917 
L 52.832257 80.781665 
L 54.388042 86.202259 
L 55.943827 91.1356 
L 57.499613 95.605788 
L 59.055398 99.636371 
L 60.611183 103.250345 
L 62.166968 106.470156 
L 63.722753 109.317701 
L 65.278538 111.814323 
L 66.834323 113.980816 
L 68.390108 115.837423 
L 69.945894 117.403837 
L 71.501679 118.699197 
L 73.057464 119.742096 
L 74.613249 120.550572 
L 76.169034 121.142114 
L 77.724819 121.53366 
L 79.280604 121.741597 
L 80.836389 121.781761 
L 82.392175 121.669439 
L 83.94796 121.419363 
L 85.503745 121.045719 
L 87.05953 120.562139 
L 88.615315 119.981706 
L 90.1711 119.31695 
L 91.726885 118.579852 
L 93.28267 117.781842 
L 94.838456 116.933798 
L 96.394241 116.046049 
L 97.950026 115.128372 
L 99.505811 114.189992 
L 101.061596 113.239587 
L 102.617381 112.28528 
L 104.173166 111.334645 
L 105.728951 110.394705 
L 107.284737 109.471932 
L 108.840522 108.572249 
L 110.396307 107.701025 
L 111.952092 106.863079 
L 113.507877 106.062682 
L 115.063662 105.303551 
L 116.619447 104.588854 
L 118.175232 103.921206 
L 119.731018 103.302673 
L 121.286803 102.734771 
L 122.842588 102.218463 
L 124.398373 101.754162 
L 125.954158 101.34173 
L 127.509943 100.98048 
L 129.065728 100.669171 
L 130.621513 100.406014 
L 132.177299 100.188667 
L 133.733084 100.014238 
L 135.288869 99.879286 
L 136.844654 99.779815 
L 138.400439 99.711283 
L 139.956224 99.668594 
L 141.512009 99.646102 
L 143.067794 99.63761 
L 144.62358 99.636371 
L 146.179365 99.635086 
L 147.73515 99.625905 
L 149.290935 99.60043 
L 150.84672 99.549708 
L 152.402505 99.464238 
L 153.95829 99.333967 
L 155.514075 99.148293 
L 157.069861 98.89606 
L 158.625646 98.565564 
L 160.181431 98.144549 
L 161.737216 97.620208 
L 163.293001 96.979183 
L 164.848786 96.207567 
L 166.404571 95.290899 
L 167.960356 94.214171 
L 169.516142 92.96182 
L 171.071927 91.517736 
L 172.627712 89.865256 
L 174.183497 87.987167 
L 175.739282 85.865704 
L 177.295067 83.482552 
L 178.850852 80.818846 
L 180.406637 77.855169 
L 181.962423 74.571553 
L 183.518208 70.947481 
L 185.073993 66.961882 
L 186.629778 62.593138 
L 188.185563 57.819077 
L 189.741348 52.616978 
L 191.297133 46.963569 
L 192.852918 40.835025 
L 194.408704 34.206973 
L 195.964489 27.054489 
&quot; style=&quot;fill:none;stroke:#1f77b4;stroke-linecap:square;stroke-width:1.5;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;PathCollection_1&quot;&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
&quot; id=&quot;mbfab10810d&quot; style=&quot;stroke:#ff0000;&quot; /&gt;
    &lt;/defs&gt;
    &lt;g clip-path=&quot;url(#pb217962a62)&quot;&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;187.40767&quot; xlink:href=&quot;#mbfab10810d&quot; y=&quot;60.25818&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_3&quot;&gt;
    &lt;path clip-path=&quot;url(#pb217962a62)&quot; d=&quot;M 169.282635 84.820898 
L 171.09781 77.692683 
L 171.702869 78.880719 
L 178.548323 65.43963 
L 179.153381 66.627665 
L 172.307927 80.068755 
L 172.912985 81.25679 
z
&quot; style=&quot;stroke:#000000;stroke-linejoin:miter;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;matplotlib.axis_1&quot;&gt;
    &lt;g id=&quot;xtick_1&quot;&gt;
     &lt;g id=&quot;line2d_2&quot;&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 0 0 
L 0 3.5 
&quot; id=&quot;m929fe43278&quot; style=&quot;stroke:#000000;stroke-width:0.8;&quot; /&gt;
      &lt;/defs&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;41.941761&quot; xlink:href=&quot;#m929fe43278&quot; y=&quot;126.518125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_1&quot;&gt;
      &lt;!-- â6 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
&quot; id=&quot;DejaVuSans-8722&quot; /&gt;
       &lt;path d=&quot;M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
&quot; id=&quot;DejaVuSans-54&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(34.570668 141.116562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-8722&quot; /&gt;
       &lt;use x=&quot;83.789062&quot; xlink:href=&quot;#DejaVuSans-54&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_2&quot;&gt;
     &lt;g id=&quot;line2d_3&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;76.169034&quot; xlink:href=&quot;#m929fe43278&quot; y=&quot;126.518125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_2&quot;&gt;
      &lt;!-- â4 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
&quot; id=&quot;DejaVuSans-52&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(68.79794 141.116562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-8722&quot; /&gt;
       &lt;use x=&quot;83.789062&quot; xlink:href=&quot;#DejaVuSans-52&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_3&quot;&gt;
     &lt;g id=&quot;line2d_4&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;110.396307&quot; xlink:href=&quot;#m929fe43278&quot; y=&quot;126.518125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_3&quot;&gt;
      &lt;!-- â2 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
&quot; id=&quot;DejaVuSans-50&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(103.025213 141.116562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-8722&quot; /&gt;
       &lt;use x=&quot;83.789062&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_4&quot;&gt;
     &lt;g id=&quot;line2d_5&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;144.62358&quot; xlink:href=&quot;#m929fe43278&quot; y=&quot;126.518125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_4&quot;&gt;
      &lt;!-- 0 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
&quot; id=&quot;DejaVuSans-48&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(141.44233 141.116562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_5&quot;&gt;
     &lt;g id=&quot;line2d_6&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;178.850852&quot; xlink:href=&quot;#m929fe43278&quot; y=&quot;126.518125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_5&quot;&gt;
      &lt;!-- 2 --&gt;
      &lt;g transform=&quot;translate(175.669602 141.116562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_6&quot;&gt;
     &lt;!-- $x$ --&gt;
     &lt;defs&gt;
      &lt;path d=&quot;M 60.015625 54.6875 
L 34.90625 27.875 
L 50.296875 0 
L 39.984375 0 
L 28.421875 21.6875 
L 8.296875 0 
L -2.59375 0 
L 24.3125 28.8125 
L 10.015625 54.6875 
L 20.3125 54.6875 
L 30.8125 34.90625 
L 49.125 54.6875 
z
&quot; id=&quot;DejaVuSans-Oblique-120&quot; /&gt;
     &lt;/defs&gt;
     &lt;g transform=&quot;translate(115.953125 154.794687)scale(0.1 -0.1)&quot;&gt;
      &lt;use transform=&quot;translate(0 0.3125)&quot; xlink:href=&quot;#DejaVuSans-Oblique-120&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;matplotlib.axis_2&quot;&gt;
    &lt;g id=&quot;ytick_1&quot;&gt;
     &lt;g id=&quot;line2d_7&quot;&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 0 0 
L -3.5 0 
&quot; id=&quot;me9152f5346&quot; style=&quot;stroke:#000000;stroke-width:0.8;&quot; /&gt;
      &lt;/defs&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;34.240625&quot; xlink:href=&quot;#me9152f5346&quot; y=&quot;99.636371&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_7&quot;&gt;
      &lt;!-- 2 --&gt;
      &lt;g transform=&quot;translate(20.878125 103.43559)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_2&quot;&gt;
     &lt;g id=&quot;line2d_8&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;34.240625&quot; xlink:href=&quot;#me9152f5346&quot; y=&quot;66.033648&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_8&quot;&gt;
      &lt;!-- 3 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
&quot; id=&quot;DejaVuSans-51&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(20.878125 69.832866)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-51&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_3&quot;&gt;
     &lt;g id=&quot;line2d_9&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;34.240625&quot; xlink:href=&quot;#me9152f5346&quot; y=&quot;32.430924&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_9&quot;&gt;
      &lt;!-- 4 --&gt;
      &lt;g transform=&quot;translate(20.878125 36.230143)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-52&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_10&quot;&gt;
     &lt;!-- $C(x)$ --&gt;
     &lt;defs&gt;
      &lt;path d=&quot;M 69.484375 67.28125 
L 67.484375 56.890625 
Q 62.796875 61.625 57.546875 63.921875 
Q 52.296875 66.21875 46.1875 66.21875 
Q 37.84375 66.21875 31.515625 62.203125 
Q 25.203125 58.203125 20.609375 50 
Q 17.671875 44.734375 16.125 38.84375 
Q 14.59375 32.953125 14.59375 27 
Q 14.59375 17.046875 19.75 11.8125 
Q 24.90625 6.59375 34.71875 6.59375 
Q 41.5 6.59375 47.75 8.765625 
Q 54 10.9375 59.90625 15.28125 
L 57.625 3.609375 
Q 51.8125 1.125 45.875 -0.140625 
Q 39.9375 -1.421875 33.984375 -1.421875 
Q 19.96875 -1.421875 12.078125 6.1875 
Q 4.203125 13.8125 4.203125 27.390625 
Q 4.203125 36.078125 7.203125 44.46875 
Q 10.203125 52.875 15.828125 59.8125 
Q 21.78125 67.1875 29.421875 70.703125 
Q 37.0625 74.21875 47.21875 74.21875 
Q 53.46875 74.21875 59.0625 72.484375 
Q 64.65625 70.75 69.484375 67.28125 
z
&quot; id=&quot;DejaVuSans-Oblique-67&quot; /&gt;
      &lt;path d=&quot;M 31 75.875 
Q 24.46875 64.65625 21.28125 53.65625 
Q 18.109375 42.671875 18.109375 31.390625 
Q 18.109375 20.125 21.3125 9.0625 
Q 24.515625 -2 31 -13.1875 
L 23.1875 -13.1875 
Q 15.875 -1.703125 12.234375 9.375 
Q 8.59375 20.453125 8.59375 31.390625 
Q 8.59375 42.28125 12.203125 53.3125 
Q 15.828125 64.359375 23.1875 75.875 
z
&quot; id=&quot;DejaVuSans-40&quot; /&gt;
      &lt;path d=&quot;M 8.015625 75.875 
L 15.828125 75.875 
Q 23.140625 64.359375 26.78125 53.3125 
Q 30.421875 42.28125 30.421875 31.390625 
Q 30.421875 20.453125 26.78125 9.375 
Q 23.140625 -1.703125 15.828125 -13.1875 
L 8.015625 -13.1875 
Q 14.5 -2 17.703125 9.0625 
Q 20.90625 20.125 20.90625 31.390625 
Q 20.90625 42.671875 17.703125 53.65625 
Q 14.5 64.65625 8.015625 75.875 
z
&quot; id=&quot;DejaVuSans-41&quot; /&gt;
     &lt;/defs&gt;
     &lt;g transform=&quot;translate(14.798438 84.818125)rotate(-90)scale(0.1 -0.1)&quot;&gt;
      &lt;use transform=&quot;translate(0 0.125)&quot; xlink:href=&quot;#DejaVuSans-Oblique-67&quot; /&gt;
      &lt;use transform=&quot;translate(69.824219 0.125)&quot; xlink:href=&quot;#DejaVuSans-40&quot; /&gt;
      &lt;use transform=&quot;translate(108.837891 0.125)&quot; xlink:href=&quot;#DejaVuSans-Oblique-120&quot; /&gt;
      &lt;use transform=&quot;translate(168.017578 0.125)&quot; xlink:href=&quot;#DejaVuSans-41&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_4&quot;&gt;
    &lt;path d=&quot;M 34.240625 126.518125 
L 34.240625 22.318125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_5&quot;&gt;
    &lt;path d=&quot;M 203.665625 126.518125 
L 203.665625 22.318125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_6&quot;&gt;
    &lt;path d=&quot;M 34.240625 126.518125 
L 203.665625 126.518125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_7&quot;&gt;
    &lt;path d=&quot;M 34.240625 22.318125 
L 203.665625 22.318125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_11&quot;&gt;
    &lt;!-- Initial situation --&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 9.8125 72.90625 
L 19.671875 72.90625 
L 19.671875 0 
L 9.8125 0 
z
&quot; id=&quot;DejaVuSans-73&quot; /&gt;
     &lt;path d=&quot;M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
&quot; id=&quot;DejaVuSans-110&quot; /&gt;
     &lt;path d=&quot;M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
&quot; id=&quot;DejaVuSans-105&quot; /&gt;
     &lt;path d=&quot;M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
&quot; id=&quot;DejaVuSans-116&quot; /&gt;
     &lt;path d=&quot;M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
&quot; id=&quot;DejaVuSans-97&quot; /&gt;
     &lt;path d=&quot;M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
&quot; id=&quot;DejaVuSans-108&quot; /&gt;
     &lt;path id=&quot;DejaVuSans-32&quot; /&gt;
     &lt;path d=&quot;M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
&quot; id=&quot;DejaVuSans-115&quot; /&gt;
     &lt;path d=&quot;M 8.5 21.578125 
L 8.5 54.6875 
L 17.484375 54.6875 
L 17.484375 21.921875 
Q 17.484375 14.15625 20.5 10.265625 
Q 23.53125 6.390625 29.59375 6.390625 
Q 36.859375 6.390625 41.078125 11.03125 
Q 45.3125 15.671875 45.3125 23.6875 
L 45.3125 54.6875 
L 54.296875 54.6875 
L 54.296875 0 
L 45.3125 0 
L 45.3125 8.40625 
Q 42.046875 3.421875 37.71875 1 
Q 33.40625 -1.421875 27.6875 -1.421875 
Q 18.265625 -1.421875 13.375 4.4375 
Q 8.5 10.296875 8.5 21.578125 
z
M 31.109375 56 
z
&quot; id=&quot;DejaVuSans-117&quot; /&gt;
     &lt;path d=&quot;M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
&quot; id=&quot;DejaVuSans-111&quot; /&gt;
    &lt;/defs&gt;
    &lt;g transform=&quot;translate(74.327188 16.318125)scale(0.12 -0.12)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-73&quot; /&gt;
     &lt;use x=&quot;29.492188&quot; xlink:href=&quot;#DejaVuSans-110&quot; /&gt;
     &lt;use x=&quot;92.871094&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
     &lt;use x=&quot;120.654297&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
     &lt;use x=&quot;159.863281&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
     &lt;use x=&quot;187.646484&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
     &lt;use x=&quot;248.925781&quot; xlink:href=&quot;#DejaVuSans-108&quot; /&gt;
     &lt;use x=&quot;276.708984&quot; xlink:href=&quot;#DejaVuSans-32&quot; /&gt;
     &lt;use x=&quot;308.496094&quot; xlink:href=&quot;#DejaVuSans-115&quot; /&gt;
     &lt;use x=&quot;360.595703&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
     &lt;use x=&quot;388.378906&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
     &lt;use x=&quot;427.587891&quot; xlink:href=&quot;#DejaVuSans-117&quot; /&gt;
     &lt;use x=&quot;490.966797&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
     &lt;use x=&quot;552.246094&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
     &lt;use x=&quot;591.455078&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
     &lt;use x=&quot;619.238281&quot; xlink:href=&quot;#DejaVuSans-111&quot; /&gt;
     &lt;use x=&quot;680.419922&quot; xlink:href=&quot;#DejaVuSans-110&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
  &lt;/g&gt;
  &lt;g id=&quot;axes_2&quot;&gt;
   &lt;g id=&quot;patch_8&quot;&gt;
    &lt;path d=&quot;M 244.840625 126.518125 
L 414.265625 126.518125 
L 414.265625 22.318125 
L 244.840625 22.318125 
z
&quot; style=&quot;fill:#ffffff;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;line2d_10&quot;&gt;
    &lt;path clip-path=&quot;url(#p709f52c006)&quot; d=&quot;M 252.541761 27.054489 
L 254.097546 36.606879 
L 255.653332 45.487904 
L 257.209117 53.725517 
L 258.764902 61.347122 
L 260.320687 68.379573 
L 261.876472 74.84917 
L 263.432257 80.781665 
L 264.988042 86.202259 
L 266.543827 91.1356 
L 268.099613 95.605788 
L 269.655398 99.636371 
L 271.211183 103.250345 
L 272.766968 106.470156 
L 274.322753 109.317701 
L 275.878538 111.814323 
L 277.434323 113.980816 
L 278.990108 115.837423 
L 280.545894 117.403837 
L 282.101679 118.699197 
L 283.657464 119.742096 
L 285.213249 120.550572 
L 286.769034 121.142114 
L 288.324819 121.53366 
L 289.880604 121.741597 
L 291.436389 121.781761 
L 292.992175 121.669439 
L 294.54796 121.419363 
L 296.103745 121.045719 
L 297.65953 120.562139 
L 299.215315 119.981706 
L 300.7711 119.31695 
L 302.326885 118.579852 
L 303.88267 117.781842 
L 305.438456 116.933798 
L 306.994241 116.046049 
L 308.550026 115.128372 
L 310.105811 114.189992 
L 311.661596 113.239587 
L 313.217381 112.28528 
L 314.773166 111.334645 
L 316.328951 110.394705 
L 317.884737 109.471932 
L 319.440522 108.572249 
L 320.996307 107.701025 
L 322.552092 106.863079 
L 324.107877 106.062682 
L 325.663662 105.303551 
L 327.219447 104.588854 
L 328.775232 103.921206 
L 330.331018 103.302673 
L 331.886803 102.734771 
L 333.442588 102.218463 
L 334.998373 101.754162 
L 336.554158 101.34173 
L 338.109943 100.98048 
L 339.665728 100.669171 
L 341.221513 100.406014 
L 342.777299 100.188667 
L 344.333084 100.014238 
L 345.888869 99.879286 
L 347.444654 99.779815 
L 349.000439 99.711283 
L 350.556224 99.668594 
L 352.112009 99.646102 
L 353.667794 99.63761 
L 355.22358 99.636371 
L 356.779365 99.635086 
L 358.33515 99.625905 
L 359.890935 99.60043 
L 361.44672 99.549708 
L 363.002505 99.464238 
L 364.55829 99.333967 
L 366.114075 99.148293 
L 367.669861 98.89606 
L 369.225646 98.565564 
L 370.781431 98.144549 
L 372.337216 97.620208 
L 373.893001 96.979183 
L 375.448786 96.207567 
L 377.004571 95.290899 
L 378.560356 94.214171 
L 380.116142 92.96182 
L 381.671927 91.517736 
L 383.227712 89.865256 
L 384.783497 87.987167 
L 386.339282 85.865704 
L 387.895067 83.482552 
L 389.450852 80.818846 
L 391.006637 77.855169 
L 392.562423 74.571553 
L 394.118208 70.947481 
L 395.673993 66.961882 
L 397.229778 62.593138 
L 398.785563 57.819077 
L 400.341348 52.616978 
L 401.897133 46.963569 
L 403.452918 40.835025 
L 405.008704 34.206973 
L 406.564489 27.054489 
&quot; style=&quot;fill:none;stroke:#1f77b4;stroke-linecap:square;stroke-width:1.5;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;PathCollection_2&quot;&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
&quot; id=&quot;m7d3e8197bf&quot; style=&quot;stroke:#00ff00;&quot; /&gt;
    &lt;/defs&gt;
    &lt;g clip-path=&quot;url(#p709f52c006)&quot;&gt;
     &lt;use style=&quot;fill:#00ff00;stroke:#00ff00;&quot; x=&quot;291.436389&quot; xlink:href=&quot;#m7d3e8197bf&quot; y=&quot;121.781761&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;matplotlib.axis_3&quot;&gt;
    &lt;g id=&quot;xtick_6&quot;&gt;
     &lt;g id=&quot;line2d_11&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;252.541761&quot; xlink:href=&quot;#m929fe43278&quot; y=&quot;126.518125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_12&quot;&gt;
      &lt;!-- â6 --&gt;
      &lt;g transform=&quot;translate(245.170668 141.116562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-8722&quot; /&gt;
       &lt;use x=&quot;83.789062&quot; xlink:href=&quot;#DejaVuSans-54&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_7&quot;&gt;
     &lt;g id=&quot;line2d_12&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;286.769034&quot; xlink:href=&quot;#m929fe43278&quot; y=&quot;126.518125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_13&quot;&gt;
      &lt;!-- â4 --&gt;
      &lt;g transform=&quot;translate(279.39794 141.116562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-8722&quot; /&gt;
       &lt;use x=&quot;83.789062&quot; xlink:href=&quot;#DejaVuSans-52&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_8&quot;&gt;
     &lt;g id=&quot;line2d_13&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;320.996307&quot; xlink:href=&quot;#m929fe43278&quot; y=&quot;126.518125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_14&quot;&gt;
      &lt;!-- â2 --&gt;
      &lt;g transform=&quot;translate(313.625213 141.116562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-8722&quot; /&gt;
       &lt;use x=&quot;83.789062&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_9&quot;&gt;
     &lt;g id=&quot;line2d_14&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;355.22358&quot; xlink:href=&quot;#m929fe43278&quot; y=&quot;126.518125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_15&quot;&gt;
      &lt;!-- 0 --&gt;
      &lt;g transform=&quot;translate(352.04233 141.116562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_10&quot;&gt;
     &lt;g id=&quot;line2d_15&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;389.450852&quot; xlink:href=&quot;#m929fe43278&quot; y=&quot;126.518125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_16&quot;&gt;
      &lt;!-- 2 --&gt;
      &lt;g transform=&quot;translate(386.269602 141.116562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_17&quot;&gt;
     &lt;!-- $x$ --&gt;
     &lt;g transform=&quot;translate(326.553125 154.794687)scale(0.1 -0.1)&quot;&gt;
      &lt;use transform=&quot;translate(0 0.3125)&quot; xlink:href=&quot;#DejaVuSans-Oblique-120&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;matplotlib.axis_4&quot;&gt;
    &lt;g id=&quot;ytick_4&quot;&gt;
     &lt;g id=&quot;line2d_16&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;244.840625&quot; xlink:href=&quot;#me9152f5346&quot; y=&quot;99.636371&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_18&quot;&gt;
      &lt;!-- 2 --&gt;
      &lt;g transform=&quot;translate(231.478125 103.43559)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_5&quot;&gt;
     &lt;g id=&quot;line2d_17&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;244.840625&quot; xlink:href=&quot;#me9152f5346&quot; y=&quot;66.033648&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_19&quot;&gt;
      &lt;!-- 3 --&gt;
      &lt;g transform=&quot;translate(231.478125 69.832866)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-51&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_6&quot;&gt;
     &lt;g id=&quot;line2d_18&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;244.840625&quot; xlink:href=&quot;#me9152f5346&quot; y=&quot;32.430924&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_20&quot;&gt;
      &lt;!-- 4 --&gt;
      &lt;g transform=&quot;translate(231.478125 36.230143)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-52&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_21&quot;&gt;
     &lt;!-- $C(x)$ --&gt;
     &lt;g transform=&quot;translate(225.398438 84.818125)rotate(-90)scale(0.1 -0.1)&quot;&gt;
      &lt;use transform=&quot;translate(0 0.125)&quot; xlink:href=&quot;#DejaVuSans-Oblique-67&quot; /&gt;
      &lt;use transform=&quot;translate(69.824219 0.125)&quot; xlink:href=&quot;#DejaVuSans-40&quot; /&gt;
      &lt;use transform=&quot;translate(108.837891 0.125)&quot; xlink:href=&quot;#DejaVuSans-Oblique-120&quot; /&gt;
      &lt;use transform=&quot;translate(168.017578 0.125)&quot; xlink:href=&quot;#DejaVuSans-41&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_9&quot;&gt;
    &lt;path d=&quot;M 244.840625 126.518125 
L 244.840625 22.318125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_10&quot;&gt;
    &lt;path d=&quot;M 414.265625 126.518125 
L 414.265625 22.318125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_11&quot;&gt;
    &lt;path d=&quot;M 244.840625 126.518125 
L 414.265625 126.518125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_12&quot;&gt;
    &lt;path d=&quot;M 244.840625 22.318125 
L 414.265625 22.318125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_22&quot;&gt;
    &lt;!-- Final situation --&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 9.8125 72.90625 
L 51.703125 72.90625 
L 51.703125 64.59375 
L 19.671875 64.59375 
L 19.671875 43.109375 
L 48.578125 43.109375 
L 48.578125 34.8125 
L 19.671875 34.8125 
L 19.671875 0 
L 9.8125 0 
z
&quot; id=&quot;DejaVuSans-70&quot; /&gt;
    &lt;/defs&gt;
    &lt;g transform=&quot;translate(287.700312 16.318125)scale(0.12 -0.12)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-70&quot; /&gt;
     &lt;use x=&quot;50.269531&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
     &lt;use x=&quot;78.052734&quot; xlink:href=&quot;#DejaVuSans-110&quot; /&gt;
     &lt;use x=&quot;141.431641&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
     &lt;use x=&quot;202.710938&quot; xlink:href=&quot;#DejaVuSans-108&quot; /&gt;
     &lt;use x=&quot;230.494141&quot; xlink:href=&quot;#DejaVuSans-32&quot; /&gt;
     &lt;use x=&quot;262.28125&quot; xlink:href=&quot;#DejaVuSans-115&quot; /&gt;
     &lt;use x=&quot;314.380859&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
     &lt;use x=&quot;342.164062&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
     &lt;use x=&quot;381.373047&quot; xlink:href=&quot;#DejaVuSans-117&quot; /&gt;
     &lt;use x=&quot;444.751953&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
     &lt;use x=&quot;506.03125&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
     &lt;use x=&quot;545.240234&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
     &lt;use x=&quot;573.023438&quot; xlink:href=&quot;#DejaVuSans-111&quot; /&gt;
     &lt;use x=&quot;634.205078&quot; xlink:href=&quot;#DejaVuSans-110&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&quot;pb217962a62&quot;&gt;
   &lt;rect height=&quot;104.2&quot; width=&quot;169.425&quot; x=&quot;34.240625&quot; y=&quot;22.318125&quot; /&gt;
  &lt;/clipPath&gt;
  &lt;clipPath id=&quot;p709f52c006&quot;&gt;
   &lt;rect height=&quot;104.2&quot; width=&quot;169.425&quot; x=&quot;244.840625&quot; y=&quot;22.318125&quot; /&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The idea behind gradient descent is quite simple. Imagine that initially the KVN's system is quite wrong and we start in the leftmost situation. We compute the cost function and it happens that we are far away from the minimum, which represents the least possible error we can have with our system (that is why we needed a positive function as having negative errors doesn't make much sense). Qualitatively, we would like to &lt;em&gt;go downhill&lt;/em&gt; until we reach the minimum of the cost function, as in the leftmost plot. Following this explanation, we can imagine gradient descent as &lt;em&gt;downhill biking&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Nonetheless, there is no easy way to know if we are at the very minimum. What we can do is look at our hill and see if we are in a slope. If that is the case, we ride our bike downhill a little bit before checking again. If we repeat this procedure many many times, we will end up, ideally, in the rightmost situation: we are in the minimum (i.e. KVN gets it right the maximum number of times the system allows him) so the system is optimized.&lt;/p&gt;
&lt;p&gt;Mathematically, the slope is the derivative of the cost function with respect to the parameter set evaluated at the current parameter set. Therefore, the idea behind gradient descent is that we iteratively compute the derivative and update our parameter set such that we get closer to the minimum. Hopefully, in the end, we will reach the global minimum. The expression used for this update is:&lt;/p&gt;
&lt;p&gt;
$$ v \rightarrow v' = v - \eta \nabla C$$
&lt;/p&gt;
&lt;p&gt;Here, $v$ is the parameter set $w, b$ of the system. $\eta$ is what it is called the &lt;strong&gt;learning rate&lt;/strong&gt; which is equivalent to how long are our rides with the bycicle between slope checks. If it is too small, we will never reach the valley. If it is too big, we will end up going from one side of the valley to the other one, never reaching the bottom. The $\nabla C$ is the &lt;strong&gt;gradient of the cost function&lt;/strong&gt;, which is equivalent to the slope of the mountain. There is a $-$ sign because we always want to go down. Remember that we are downhill biking!&lt;/p&gt;
&lt;p&gt;The next question one might ask is:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Okay... but how exactly do you determine the slope of a mountain with a hell lot of dimensions?!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Remember that we have a lot of parameters and each parameter corresponds to a dimension. Thus, we have as many dimensions as parameters. The example above have only one dimension. Thus, this is a totally valid question. How would you know where &lt;em&gt;down&lt;/em&gt; is if you were in a world that has 1000 dimensions? (Our world have three spatial dimensions).&lt;/p&gt;
&lt;p&gt;As we have seen, the slope corresponds to the gradient. In computational sciences, gradients are usually computed by what is called &lt;strong&gt;finite differences&lt;/strong&gt;. We won't discuss that here but the idea is that it requires to compute what happens to the cost function if we vary by a small amount a single parameter. And repeat for all parameters. This means that in order to determine the slope at every check, we have to compute the cost function as many times as parameters we have (a lot). And remember that in order to evaluate the cost functions we saw above we have to evaluate all training examples. Although this works, it is extremely slow. And by extremely I mean prohibitively slow. In our biking situation, night would fall upon us and no one wants to bike at night, for night is dark and full of terrors.&lt;/p&gt;
&lt;p&gt;One way to speed things up is what is called &lt;strong&gt;stochastic gradient descent&lt;/strong&gt;. The idea is that instead of using &lt;em&gt;all&lt;/em&gt; input examples at each step, we use a random subsample of them, a &lt;em&gt;mini-batch&lt;/em&gt; at each slope check. Then, the cost function is computed for this subsample and used to determine the slope. In the next check, a different subsample is used. This procedure is repeated until all training samples have been used which is said to complete an &lt;em&gt;epoch&lt;/em&gt; of training. After each epoch, the procedure is started again.&lt;/p&gt;
&lt;p&gt;Using this method, we only get an idea of where down is at each check, but an idea is sufficient to advance a bit. It is like our sense of equilibrium is a bit distorted but we always know more or less where down is. That way, KVN only has to look at a fraction of the images to learn a bit and is faster in dismounting, checking and riding the bike again. The path that KVN will follow with stochastic gradient descent will be less direct but the overall ride will also be much faster. Altough this method can improve the speed, the slope check is still too slow.&lt;/p&gt;
&lt;h3 id=&quot;The-slopemeter-(a.k.a.-Backpropagation)&quot;&gt;The slopemeter (a.k.a. Backpropagation)&lt;a class=&quot;anchor-link&quot; href=&quot;#The-slopemeter-(a.k.a.-Backpropagation)&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The method usually used to compute the slope is the &lt;strong&gt;backpropagation algorithm&lt;/strong&gt;. The idea is that using the chain rule of basic calculus, we can compute which effect a small perturbation of a parameter will have in the final cost function. These effects are actually the derivatives we were talking before, so what we are saying is that we use the chain rule to obtain simple forms to compute the derivatives. The name backpropagation comes from the fact that the algorithm starts at the output, and from the error in the cost function backpropagates through the network computing these perturbations and thus, obtaining the derivatives.&lt;/p&gt;
&lt;p&gt;In the end, this means that each slope check, the network has to be used once per training sample (or image) in the mini-batch in the forward direction to compute the cost function (check how wrong KVN is in each image) and once per sample in the backward direction to compute the gradient (how different would be the error if some parameter was different). In the end, this method is much much faster than finite differences and allow neural networks to be really feasible.&lt;/p&gt;
&lt;p&gt;My dear readers, we have finally revised all the building blocks required to understand the system we intend to implement into KVN for him to recognize the bingo digits. Time to get the job done! In the next part, we will finally teach KVN what it needs to know!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://bepuca.dev/machine%20learning/2020/05/24/kvn-part-1.html&quot;&gt;Part 1&lt;/a&gt;: Definition of Neural Networks at the problem at hand. Friendly context introduction.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://bepuca.dev/machine%20learning/2020/06/13/kvn-part-3.html&quot;&gt;Part 3&lt;/a&gt;: Actual training of a Neural Network to identify handwritten digits.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">KVN, Margaret &amp;amp; bingo - Part 1</title><link href="https://bepuca.dev/machine%20learning/2020/05/24/kvn-part-1.html" rel="alternate" type="text/html" title="KVN, Margaret &amp; bingo - Part 1" /><published>2020-05-24T00:00:00-05:00</published><updated>2020-05-24T00:00:00-05:00</updated><id>https://bepuca.dev/machine%20learning/2020/05/24/kvn-part-1</id><content type="html" xml:base="https://bepuca.dev/machine%20learning/2020/05/24/kvn-part-1.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-24-kvn-part-1.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Neural Networks&lt;/strong&gt; (NNs) are truly a hot topic these days. Or at least, the so-called Artificial Intelligence is. Nonetheless, I realized that, for most of my friends outside the machine learning niche, Neural Networks seem like dark magic (at least for the ones that care enough to ask). Here, I want to present an entertaining and illustrating narrative on what NNs are, how they work and an example of a problem that can (and actually is) solved by the technology.
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;You will find here some of the mathematics and technical concepts. I introduce them for rigurosity and also to allow interested readers to delve deeper. I tried to make it approachable no matter what. So just skip whatever feels too technical and you will also understand the concepts, hopefully. If, despite that, you still have questions, please ask them in the comments!
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Our-very-realistic-problem&quot;&gt;Our very realistic problem&lt;a class=&quot;anchor-link&quot; href=&quot;#Our-very-realistic-problem&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Imagine we are part of the &lt;strong&gt;ABC, the Amazing Bingo Club&lt;/strong&gt;. This year it's the 100th anniversary of the club and a big event is coming up. We will have the biggest &lt;a href=&quot;https://en.wikipedia.org/wiki/Bingo_(American_version&quot;&gt;bingo&lt;/a&gt;) game the ABC has ever seen, for all the 29 members will be present! Moreover, we want to honor our beloved founder Margaret by letting her draw and call the numbers. But there is a problem. Margaret is blind now.&lt;/p&gt;
&lt;p&gt;Let me say it again: &lt;strong&gt;Margaret. is. blind.&lt;/strong&gt; :scream:&lt;/p&gt;
&lt;p&gt;Fear not! We may have a solution. One of the members of the club has a KVN (pronounced Kevin), from the &lt;a href=&quot;https://en.wikipedia.org/wiki/Final_Space&quot;&gt;Final Space&lt;/a&gt; (much recommended series) universe. Meet KVN:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/kvn/kvn.png&quot; alt=&quot;&quot; title=&quot;KVN, a Deep Space Insanity Avoidance Companion.&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;KVN is a robot usually employed as a Deep Space Insanity Avoidance Companion. Now, we want to use it to read the numbers that Margaret draws and whisper them to her so she can then call the numbers aloud. The situation here is that KVN doesn't have a number recognition system implemented. That is, KVN can see but he is not able to recognize numbers... The good news are that we have access to KVN's main system, so if we are skilled enough, we could implement a digit recognizer into him.&lt;/p&gt;
&lt;p&gt;But there is yet another problem (and we hope it to be the last). The ABC is in a really low budget so the numbers that Margaret will draw are handwritten numbers in small pieces of paper. Thus, we cannot just make KVN recognize some standard digits. Moreover, in the 100 years of the club, some numbers have been lost and replaced by many different members. So, in the end, we have a lot of different number styles within our bingo set.&lt;/p&gt;
&lt;p&gt;In summary, then, we would like for KVN to be able to read handwritten digits similar to the ones below and whisper to Margaret:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;It's a 2...&lt;/em&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/kvn/digit_examples.png&quot; alt=&quot;&quot; title=&quot;Examples of 2 in the ABC bingo set.&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Yeah, right, everything sounds pretty cool but how do we do it?&lt;/p&gt;
&lt;p&gt;Well, one might think in the possibility to hardcode inside KVN's brain some rules to identify numbers such as the 2's have a semicircle on top, probably a loop on the bottom left, etc... As one can already divise, this is a ton of work for not so promising results. If that's not enough, it is also not that straightforward how to define such rules.&lt;/p&gt;
&lt;p&gt;But what if we could show KVN a lot of examples of numbers so he can create his own rules to recognize them? What if we could do something like...&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Us&lt;/strong&gt;: Look KVN, this is a 2, this is also a 2, this is a 1, this is an 8, this is also an 8, etc.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Us&lt;/strong&gt;: &lt;em&gt;*Showing him a new 2*&lt;/em&gt; What is this?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;KVN&lt;/strong&gt;: A 2!!!!&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Here is when Neural Networks (NN) enter the game. &lt;strong&gt;NNs are a tool that will allow KVN to learn to recognize digits as described above.&lt;/strong&gt;
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;What we are talking here is supervised learning of image classification, in the sense that we have labeled examples to teach KVN (e.g. images of 2 that we know are a 2) and the goal is to identify which number the image represents. NNs are used in a myriad of problems, not solely in supervised learning nor image classification.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;First-things-first&quot;&gt;First things first&lt;a class=&quot;anchor-link&quot; href=&quot;#First-things-first&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;When we talk about Neural Networks, we are actually talking about &lt;strong&gt;Artifical Neural Networks&lt;/strong&gt; (ANNs). ANNs are vaguely inspired by the Biological Neural Networks (BNNs). BNNs or neural circuits are groups of interconnected neurons, a type of cell of the nervous system (including the brain). That is, your brain is full of BNN (among other things).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Neurons&quot;&gt;Neurons&lt;a class=&quot;anchor-link&quot; href=&quot;#Neurons&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;These cells called neurons constitute a great part of our brain. Here a neuron:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/kvn/neuron.png&quot; alt=&quot;&quot; title=&quot;Credit: https://en.wikipedia.org/wiki/Neuron&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Their function, extremely simplified, is to transmit information. The way they work is the following:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;A neuron receives a series of inputs from other neurons.&lt;/li&gt;
&lt;li&gt;If the sum of these inputs is above a certain threshold, the neuron triggers and emits an output (that will go to other neurons).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;More or less, we have 100 billion of these in our brain, which is A LOT. In principle, thanks to them we are able to sense and think but we will not delve deep into this.&lt;/p&gt;
&lt;p&gt;The main idea we are interested in is: if we can learn with our brains which are constituted by neurons which are heavily interconnected... can we program artificial neurons, interconnect them and obtain an artificial brain that does something similar? Well, this is exactly what ANNs (NNs from now on) try to do.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Artificial-neurons&quot;&gt;Artificial neurons&lt;a class=&quot;anchor-link&quot; href=&quot;#Artificial-neurons&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In order to mimic the behaviour of neurons, artifical neurons are usually modeled as follows (image source):&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/kvn/artificial_neuron.png&quot; alt=&quot;&quot; title=&quot;Artificial neuron. Credit: https://sausheong.github.io/posts/how-to-build-a-simple-artificial-neural-network-with-go/&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As we can see, these neurons have a series of &lt;strong&gt;inputs&lt;/strong&gt; $i_i$, a &lt;strong&gt;weight&lt;/strong&gt; $w_i$ associated with each input, an &lt;strong&gt;activation function&lt;/strong&gt; $\sigma$ and an &lt;strong&gt;output&lt;/strong&gt; $o$.&lt;/p&gt;
&lt;p&gt;This might seem a bit obscure so let's try to clarify it a bit. The typical example used to explain artificial neurons is the following: Imagine there is a concert of our favourite group on Saturday and we want to decide whether or not to attend it. In order to take this decision, we consider several factors:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Will someone come with me?&lt;/li&gt;
&lt;li&gt;Will it be good weather?&lt;/li&gt;
&lt;li&gt;Can I go there by public transportation?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To all these questions, which are my inputs $i_i$, affirmative answers (i.e. $1$) are good. But are they equally important? It might be the case that I don't really care if I have to go alone but I cannot withstand bad weather. How do I represent this? The weights $w_i$ are exactly for that. Bigger $w_i$ means bigger importance. Then, the activation function $\sigma$ is my &lt;em&gt;decision function&lt;/em&gt;. A very simple function would be:&lt;/p&gt;
$$ o = \sigma(i) = 
\begin{cases}
    1,&amp;amp; \text{if } \sum_i w_i i_i \gt threshold\\
    0 ,&amp;amp; \text{if } \sum_i w_i i_i \lt threshold
\end{cases}
$$&lt;p&gt;That is, if the &lt;strong&gt;weighted input&lt;/strong&gt; $\sum_i w_i i_i$ is greater than a &lt;strong&gt;threshold&lt;/strong&gt;, the output $o$ will be $o=1$, I will go to the concert. In other words, only when the conditions I am considering to go to the concert are good enough for me I will attend the event.&lt;/p&gt;
&lt;p&gt;In the neuron model, we can see that we have $\Sigma | \sigma$. This is because the illustrative case is to use as an activation function the one explained above, which is simply the sum $\Sigma$ of the weighted inputs. But in general, the activation function used are a little bit more complicated than that. The idea is to introduce non-linearity, but it will stay out of the scope of this series. A general expression for these artificial neurons is:&lt;/p&gt;
&lt;p&gt;
$$ o = \sigma \big( \sum_i w_i i_i + b \big) $$
&lt;/p&gt;
&lt;p&gt;Notice that a $b$, called &lt;strong&gt;bias&lt;/strong&gt;, has appeared. This is equivalent to the threshold we were talking before, just a little rearranged. It can be thought as &lt;em&gt;how difficult&lt;/em&gt; is to trigger the neuron.&lt;/p&gt;
&lt;p&gt;There are many activation functions. The most popular are the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Sigmoid function&lt;/strong&gt;:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
$$ \sigma(x) = \frac{1}{1+e^{-x}} $$
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Rectifier function&lt;/strong&gt; (sometimes called ReLU):&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
$$ \sigma(x) = \max(0,x) $$
&lt;/p&gt;
&lt;p&gt;And their shape:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define x grid.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;xx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define response from the different activation functions.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_sig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_relu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot the activation functions.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Sigmoid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;121&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_sig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Sigmoid&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;$x$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;$\sigma(x)$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ReLU&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;122&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;ReLU&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;$x$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;$\sigma(x)$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tight_layout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_svg output_subarea &quot;&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;
&amp;lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot;
  &quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&amp;gt;
&lt;!-- Created with matplotlib (https://matplotlib.org/) --&gt;
&lt;svg height=&quot;207.274375pt&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 565.50625 207.274375&quot; width=&quot;565.50625pt&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;
 &lt;defs&gt;
  &lt;style type=&quot;text/css&quot;&gt;
*{stroke-linecap:butt;stroke-linejoin:round;}
  &lt;/style&gt;
 &lt;/defs&gt;
 &lt;g id=&quot;figure_1&quot;&gt;
  &lt;g id=&quot;patch_1&quot;&gt;
   &lt;path d=&quot;M 0 207.274375 
L 565.50625 207.274375 
L 565.50625 0 
L 0 0 
z
&quot; style=&quot;fill:none;&quot; /&gt;
  &lt;/g&gt;
  &lt;g id=&quot;axes_1&quot;&gt;
   &lt;g id=&quot;patch_2&quot;&gt;
    &lt;path d=&quot;M 43.78125 169.718125 
L 280.45625 169.718125 
L 280.45625 22.318125 
L 43.78125 22.318125 
z
&quot; style=&quot;fill:#ffffff;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;matplotlib.axis_1&quot;&gt;
    &lt;g id=&quot;xtick_1&quot;&gt;
     &lt;g id=&quot;line2d_1&quot;&gt;
      &lt;path clip-path=&quot;url(#p0016c4ec88)&quot; d=&quot;M 54.539205 169.718125 
L 54.539205 22.318125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_2&quot;&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 0 0 
L 0 3.5 
&quot; id=&quot;m54e2513f47&quot; style=&quot;stroke:#000000;stroke-width:0.8;&quot; /&gt;
      &lt;/defs&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;54.539205&quot; xlink:href=&quot;#m54e2513f47&quot; y=&quot;169.718125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_1&quot;&gt;
      &lt;!-- â4 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
&quot; id=&quot;DejaVuSans-8722&quot; /&gt;
       &lt;path d=&quot;M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
&quot; id=&quot;DejaVuSans-52&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(47.168111 184.316562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-8722&quot; /&gt;
       &lt;use x=&quot;83.789062&quot; xlink:href=&quot;#DejaVuSans-52&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_2&quot;&gt;
     &lt;g id=&quot;line2d_3&quot;&gt;
      &lt;path clip-path=&quot;url(#p0016c4ec88)&quot; d=&quot;M 108.328977 169.718125 
L 108.328977 22.318125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_4&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;108.328977&quot; xlink:href=&quot;#m54e2513f47&quot; y=&quot;169.718125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_2&quot;&gt;
      &lt;!-- â2 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
&quot; id=&quot;DejaVuSans-50&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(100.957884 184.316562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-8722&quot; /&gt;
       &lt;use x=&quot;83.789062&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_3&quot;&gt;
     &lt;g id=&quot;line2d_5&quot;&gt;
      &lt;path clip-path=&quot;url(#p0016c4ec88)&quot; d=&quot;M 162.11875 169.718125 
L 162.11875 22.318125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_6&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;162.11875&quot; xlink:href=&quot;#m54e2513f47&quot; y=&quot;169.718125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_3&quot;&gt;
      &lt;!-- 0 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
&quot; id=&quot;DejaVuSans-48&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(158.9375 184.316562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_4&quot;&gt;
     &lt;g id=&quot;line2d_7&quot;&gt;
      &lt;path clip-path=&quot;url(#p0016c4ec88)&quot; d=&quot;M 215.908523 169.718125 
L 215.908523 22.318125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_8&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;215.908523&quot; xlink:href=&quot;#m54e2513f47&quot; y=&quot;169.718125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_4&quot;&gt;
      &lt;!-- 2 --&gt;
      &lt;g transform=&quot;translate(212.727273 184.316562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_5&quot;&gt;
     &lt;g id=&quot;line2d_9&quot;&gt;
      &lt;path clip-path=&quot;url(#p0016c4ec88)&quot; d=&quot;M 269.698295 169.718125 
L 269.698295 22.318125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_10&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;269.698295&quot; xlink:href=&quot;#m54e2513f47&quot; y=&quot;169.718125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_5&quot;&gt;
      &lt;!-- 4 --&gt;
      &lt;g transform=&quot;translate(266.517045 184.316562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-52&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_6&quot;&gt;
     &lt;!-- $x$ --&gt;
     &lt;defs&gt;
      &lt;path d=&quot;M 60.015625 54.6875 
L 34.90625 27.875 
L 50.296875 0 
L 39.984375 0 
L 28.421875 21.6875 
L 8.296875 0 
L -2.59375 0 
L 24.3125 28.8125 
L 10.015625 54.6875 
L 20.3125 54.6875 
L 30.8125 34.90625 
L 49.125 54.6875 
z
&quot; id=&quot;DejaVuSans-Oblique-120&quot; /&gt;
     &lt;/defs&gt;
     &lt;g transform=&quot;translate(159.11875 197.994687)scale(0.1 -0.1)&quot;&gt;
      &lt;use transform=&quot;translate(0 0.3125)&quot; xlink:href=&quot;#DejaVuSans-Oblique-120&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;matplotlib.axis_2&quot;&gt;
    &lt;g id=&quot;ytick_1&quot;&gt;
     &lt;g id=&quot;line2d_11&quot;&gt;
      &lt;path clip-path=&quot;url(#p0016c4ec88)&quot; d=&quot;M 43.78125 165.518211 
L 280.45625 165.518211 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_12&quot;&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 0 0 
L -3.5 0 
&quot; id=&quot;m00981eb8d8&quot; style=&quot;stroke:#000000;stroke-width:0.8;&quot; /&gt;
      &lt;/defs&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;43.78125&quot; xlink:href=&quot;#m00981eb8d8&quot; y=&quot;165.518211&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_7&quot;&gt;
      &lt;!-- 0.0 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
&quot; id=&quot;DejaVuSans-46&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(20.878125 169.31743)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_2&quot;&gt;
     &lt;g id=&quot;line2d_13&quot;&gt;
      &lt;path clip-path=&quot;url(#p0016c4ec88)&quot; d=&quot;M 43.78125 137.718177 
L 280.45625 137.718177 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_14&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;43.78125&quot; xlink:href=&quot;#m00981eb8d8&quot; y=&quot;137.718177&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_8&quot;&gt;
      &lt;!-- 0.2 --&gt;
      &lt;g transform=&quot;translate(20.878125 141.517396)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_3&quot;&gt;
     &lt;g id=&quot;line2d_15&quot;&gt;
      &lt;path clip-path=&quot;url(#p0016c4ec88)&quot; d=&quot;M 43.78125 109.918142 
L 280.45625 109.918142 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_16&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;43.78125&quot; xlink:href=&quot;#m00981eb8d8&quot; y=&quot;109.918142&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_9&quot;&gt;
      &lt;!-- 0.4 --&gt;
      &lt;g transform=&quot;translate(20.878125 113.717361)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-52&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_4&quot;&gt;
     &lt;g id=&quot;line2d_17&quot;&gt;
      &lt;path clip-path=&quot;url(#p0016c4ec88)&quot; d=&quot;M 43.78125 82.118108 
L 280.45625 82.118108 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_18&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;43.78125&quot; xlink:href=&quot;#m00981eb8d8&quot; y=&quot;82.118108&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_10&quot;&gt;
      &lt;!-- 0.6 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
&quot; id=&quot;DejaVuSans-54&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(20.878125 85.917326)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-54&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_5&quot;&gt;
     &lt;g id=&quot;line2d_19&quot;&gt;
      &lt;path clip-path=&quot;url(#p0016c4ec88)&quot; d=&quot;M 43.78125 54.318073 
L 280.45625 54.318073 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_20&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;43.78125&quot; xlink:href=&quot;#m00981eb8d8&quot; y=&quot;54.318073&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_11&quot;&gt;
      &lt;!-- 0.8 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
&quot; id=&quot;DejaVuSans-56&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(20.878125 58.117292)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-56&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_6&quot;&gt;
     &lt;g id=&quot;line2d_21&quot;&gt;
      &lt;path clip-path=&quot;url(#p0016c4ec88)&quot; d=&quot;M 43.78125 26.518039 
L 280.45625 26.518039 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_22&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;43.78125&quot; xlink:href=&quot;#m00981eb8d8&quot; y=&quot;26.518039&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_12&quot;&gt;
      &lt;!-- 1.0 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
&quot; id=&quot;DejaVuSans-49&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(20.878125 30.317257)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-49&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_13&quot;&gt;
     &lt;!-- $\sigma(x)$ --&gt;
     &lt;defs&gt;
      &lt;path d=&quot;M 34.671875 47.5625 
Q 27.25 47.5625 22.21875 42.1875 
Q 16.890625 36.578125 15.140625 27.296875 
Q 13.1875 17.484375 16.3125 11.8125 
Q 19.390625 6.203125 26.65625 6.203125 
Q 33.84375 6.203125 39.109375 11.859375 
Q 44.4375 17.53125 46.34375 27.296875 
Q 48.046875 36.234375 45.015625 42.1875 
Q 42.1875 47.5625 34.671875 47.5625 
z
M 36.078125 54.734375 
L 65.921875 54.6875 
L 64.15625 45.703125 
L 54.109375 45.703125 
Q 57.90625 38.09375 55.859375 27.296875 
Q 53.21875 13.875 45.0625 6.25 
Q 36.859375 -1.421875 25.140625 -1.421875 
Q 13.375 -1.421875 8.203125 6.25 
Q 3.03125 13.875 5.671875 27.296875 
Q 8.25 40.765625 16.40625 48.390625 
Q 23.1875 54.734375 36.078125 54.734375 
z
&quot; id=&quot;DejaVuSans-Oblique-963&quot; /&gt;
      &lt;path d=&quot;M 31 75.875 
Q 24.46875 64.65625 21.28125 53.65625 
Q 18.109375 42.671875 18.109375 31.390625 
Q 18.109375 20.125 21.3125 9.0625 
Q 24.515625 -2 31 -13.1875 
L 23.1875 -13.1875 
Q 15.875 -1.703125 12.234375 9.375 
Q 8.59375 20.453125 8.59375 31.390625 
Q 8.59375 42.28125 12.203125 53.3125 
Q 15.828125 64.359375 23.1875 75.875 
z
&quot; id=&quot;DejaVuSans-40&quot; /&gt;
      &lt;path d=&quot;M 8.015625 75.875 
L 15.828125 75.875 
Q 23.140625 64.359375 26.78125 53.3125 
Q 30.421875 42.28125 30.421875 31.390625 
Q 30.421875 20.453125 26.78125 9.375 
Q 23.140625 -1.703125 15.828125 -13.1875 
L 8.015625 -13.1875 
Q 14.5 -2 17.703125 9.0625 
Q 20.90625 20.125 20.90625 31.390625 
Q 20.90625 42.671875 17.703125 53.65625 
Q 14.5 64.65625 8.015625 75.875 
z
&quot; id=&quot;DejaVuSans-41&quot; /&gt;
     &lt;/defs&gt;
     &lt;g transform=&quot;translate(14.798438 106.068125)rotate(-90)scale(0.1 -0.1)&quot;&gt;
      &lt;use transform=&quot;translate(0 0.125)&quot; xlink:href=&quot;#DejaVuSans-Oblique-963&quot; /&gt;
      &lt;use transform=&quot;translate(63.378906 0.125)&quot; xlink:href=&quot;#DejaVuSans-40&quot; /&gt;
      &lt;use transform=&quot;translate(102.392578 0.125)&quot; xlink:href=&quot;#DejaVuSans-Oblique-120&quot; /&gt;
      &lt;use transform=&quot;translate(161.572266 0.125)&quot; xlink:href=&quot;#DejaVuSans-41&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;line2d_23&quot;&gt;
    &lt;path clip-path=&quot;url(#p0016c4ec88)&quot; d=&quot;M 54.539205 163.018125 
L 56.712529 162.811808 
L 58.885853 162.588829 
L 61.059177 162.347908 
L 63.232501 162.087671 
L 65.405825 161.806657 
L 67.579149 161.503305 
L 69.752474 161.175955 
L 71.925798 160.822843 
L 74.099122 160.442099 
L 76.272446 160.031742 
L 78.44577 159.58968 
L 80.619094 159.113708 
L 82.792419 158.601509 
L 84.965743 158.050654 
L 87.139067 157.458605 
L 89.312391 156.82272 
L 91.485715 156.140258 
L 93.659039 155.408389 
L 95.832363 154.624204 
L 98.005688 153.78473 
L 100.179012 152.886945 
L 102.352336 151.927803 
L 104.52566 150.904252 
L 106.698984 149.813266 
L 108.872308 148.651878 
L 111.045632 147.417214 
L 113.218957 146.106534 
L 115.392281 144.717277 
L 117.565605 143.247109 
L 119.738929 141.693978 
L 121.912253 140.05616 
L 124.085577 138.332326 
L 126.258902 136.52159 
L 128.432226 134.623573 
L 130.60555 132.638452 
L 132.778874 130.567017 
L 134.952198 128.410714 
L 137.125522 126.171685 
L 139.298846 123.8528 
L 141.472171 121.457675 
L 143.645495 118.990682 
L 145.818819 116.45694 
L 147.992143 113.862294 
L 150.165467 111.213282 
L 152.338791 108.517077 
L 154.512115 105.781425 
L 156.68544 103.014557 
L 158.858764 100.225102 
L 161.032088 97.421976 
L 163.205412 94.614274 
L 165.378736 91.811148 
L 167.55206 89.021693 
L 169.725385 86.254825 
L 171.898709 83.519173 
L 174.072033 80.822968 
L 176.245357 78.173956 
L 178.418681 75.57931 
L 180.592005 73.045568 
L 182.765329 70.578575 
L 184.938654 68.18345 
L 187.111978 65.864565 
L 189.285302 63.625536 
L 191.458626 61.469233 
L 193.63195 59.397798 
L 195.805274 57.412677 
L 197.978598 55.51466 
L 200.151923 53.703924 
L 202.325247 51.98009 
L 204.498571 50.342272 
L 206.671895 48.789141 
L 208.845219 47.318973 
L 211.018543 45.929716 
L 213.191868 44.619036 
L 215.365192 43.384372 
L 217.538516 42.222984 
L 219.71184 41.131998 
L 221.885164 40.108447 
L 224.058488 39.149305 
L 226.231812 38.25152 
L 228.405137 37.412046 
L 230.578461 36.627861 
L 232.751785 35.895992 
L 234.925109 35.21353 
L 237.098433 34.577645 
L 239.271757 33.985596 
L 241.445081 33.434741 
L 243.618406 32.922542 
L 245.79173 32.44657 
L 247.965054 32.004508 
L 250.138378 31.594151 
L 252.311702 31.213407 
L 254.485026 30.860295 
L 256.658351 30.532945 
L 258.831675 30.229593 
L 261.004999 29.948579 
L 263.178323 29.688342 
L 265.351647 29.447421 
L 267.524971 29.224442 
L 269.698295 29.018125 
&quot; style=&quot;fill:none;stroke:#1f77b4;stroke-linecap:square;stroke-width:1.5;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_3&quot;&gt;
    &lt;path d=&quot;M 43.78125 169.718125 
L 43.78125 22.318125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_4&quot;&gt;
    &lt;path d=&quot;M 280.45625 169.718125 
L 280.45625 22.318125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_5&quot;&gt;
    &lt;path d=&quot;M 43.78125 169.718125 
L 280.45625 169.718125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_6&quot;&gt;
    &lt;path d=&quot;M 43.78125 22.318125 
L 280.45625 22.318125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_14&quot;&gt;
    &lt;!-- Sigmoid --&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 53.515625 70.515625 
L 53.515625 60.890625 
Q 47.90625 63.578125 42.921875 64.890625 
Q 37.9375 66.21875 33.296875 66.21875 
Q 25.25 66.21875 20.875 63.09375 
Q 16.5 59.96875 16.5 54.203125 
Q 16.5 49.359375 19.40625 46.890625 
Q 22.3125 44.4375 30.421875 42.921875 
L 36.375 41.703125 
Q 47.40625 39.59375 52.65625 34.296875 
Q 57.90625 29 57.90625 20.125 
Q 57.90625 9.515625 50.796875 4.046875 
Q 43.703125 -1.421875 29.984375 -1.421875 
Q 24.8125 -1.421875 18.96875 -0.25 
Q 13.140625 0.921875 6.890625 3.21875 
L 6.890625 13.375 
Q 12.890625 10.015625 18.65625 8.296875 
Q 24.421875 6.59375 29.984375 6.59375 
Q 38.421875 6.59375 43.015625 9.90625 
Q 47.609375 13.234375 47.609375 19.390625 
Q 47.609375 24.75 44.3125 27.78125 
Q 41.015625 30.8125 33.5 32.328125 
L 27.484375 33.5 
Q 16.453125 35.6875 11.515625 40.375 
Q 6.59375 45.0625 6.59375 53.421875 
Q 6.59375 63.09375 13.40625 68.65625 
Q 20.21875 74.21875 32.171875 74.21875 
Q 37.3125 74.21875 42.625 73.28125 
Q 47.953125 72.359375 53.515625 70.515625 
z
&quot; id=&quot;DejaVuSans-83&quot; /&gt;
     &lt;path d=&quot;M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
&quot; id=&quot;DejaVuSans-105&quot; /&gt;
     &lt;path d=&quot;M 45.40625 27.984375 
Q 45.40625 37.75 41.375 43.109375 
Q 37.359375 48.484375 30.078125 48.484375 
Q 22.859375 48.484375 18.828125 43.109375 
Q 14.796875 37.75 14.796875 27.984375 
Q 14.796875 18.265625 18.828125 12.890625 
Q 22.859375 7.515625 30.078125 7.515625 
Q 37.359375 7.515625 41.375 12.890625 
Q 45.40625 18.265625 45.40625 27.984375 
z
M 54.390625 6.78125 
Q 54.390625 -7.171875 48.1875 -13.984375 
Q 42 -20.796875 29.203125 -20.796875 
Q 24.46875 -20.796875 20.265625 -20.09375 
Q 16.0625 -19.390625 12.109375 -17.921875 
L 12.109375 -9.1875 
Q 16.0625 -11.328125 19.921875 -12.34375 
Q 23.78125 -13.375 27.78125 -13.375 
Q 36.625 -13.375 41.015625 -8.765625 
Q 45.40625 -4.15625 45.40625 5.171875 
L 45.40625 9.625 
Q 42.625 4.78125 38.28125 2.390625 
Q 33.9375 0 27.875 0 
Q 17.828125 0 11.671875 7.65625 
Q 5.515625 15.328125 5.515625 27.984375 
Q 5.515625 40.671875 11.671875 48.328125 
Q 17.828125 56 27.875 56 
Q 33.9375 56 38.28125 53.609375 
Q 42.625 51.21875 45.40625 46.390625 
L 45.40625 54.6875 
L 54.390625 54.6875 
z
&quot; id=&quot;DejaVuSans-103&quot; /&gt;
     &lt;path d=&quot;M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
&quot; id=&quot;DejaVuSans-109&quot; /&gt;
     &lt;path d=&quot;M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
&quot; id=&quot;DejaVuSans-111&quot; /&gt;
     &lt;path d=&quot;M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
&quot; id=&quot;DejaVuSans-100&quot; /&gt;
    &lt;/defs&gt;
    &lt;g transform=&quot;translate(137.842187 16.318125)scale(0.12 -0.12)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-83&quot; /&gt;
     &lt;use x=&quot;63.476562&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
     &lt;use x=&quot;91.259766&quot; xlink:href=&quot;#DejaVuSans-103&quot; /&gt;
     &lt;use x=&quot;154.736328&quot; xlink:href=&quot;#DejaVuSans-109&quot; /&gt;
     &lt;use x=&quot;252.148438&quot; xlink:href=&quot;#DejaVuSans-111&quot; /&gt;
     &lt;use x=&quot;313.330078&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
     &lt;use x=&quot;341.113281&quot; xlink:href=&quot;#DejaVuSans-100&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
  &lt;/g&gt;
  &lt;g id=&quot;axes_2&quot;&gt;
   &lt;g id=&quot;patch_7&quot;&gt;
    &lt;path d=&quot;M 321.63125 169.718125 
L 558.30625 169.718125 
L 558.30625 22.318125 
L 321.63125 22.318125 
z
&quot; style=&quot;fill:#ffffff;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;matplotlib.axis_3&quot;&gt;
    &lt;g id=&quot;xtick_6&quot;&gt;
     &lt;g id=&quot;line2d_24&quot;&gt;
      &lt;path clip-path=&quot;url(#p918b795b5b)&quot; d=&quot;M 332.389205 169.718125 
L 332.389205 22.318125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_25&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;332.389205&quot; xlink:href=&quot;#m54e2513f47&quot; y=&quot;169.718125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_15&quot;&gt;
      &lt;!-- â4 --&gt;
      &lt;g transform=&quot;translate(325.018111 184.316562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-8722&quot; /&gt;
       &lt;use x=&quot;83.789062&quot; xlink:href=&quot;#DejaVuSans-52&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_7&quot;&gt;
     &lt;g id=&quot;line2d_26&quot;&gt;
      &lt;path clip-path=&quot;url(#p918b795b5b)&quot; d=&quot;M 386.178977 169.718125 
L 386.178977 22.318125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_27&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;386.178977&quot; xlink:href=&quot;#m54e2513f47&quot; y=&quot;169.718125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_16&quot;&gt;
      &lt;!-- â2 --&gt;
      &lt;g transform=&quot;translate(378.807884 184.316562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-8722&quot; /&gt;
       &lt;use x=&quot;83.789062&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_8&quot;&gt;
     &lt;g id=&quot;line2d_28&quot;&gt;
      &lt;path clip-path=&quot;url(#p918b795b5b)&quot; d=&quot;M 439.96875 169.718125 
L 439.96875 22.318125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_29&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;439.96875&quot; xlink:href=&quot;#m54e2513f47&quot; y=&quot;169.718125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_17&quot;&gt;
      &lt;!-- 0 --&gt;
      &lt;g transform=&quot;translate(436.7875 184.316562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_9&quot;&gt;
     &lt;g id=&quot;line2d_30&quot;&gt;
      &lt;path clip-path=&quot;url(#p918b795b5b)&quot; d=&quot;M 493.758523 169.718125 
L 493.758523 22.318125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_31&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;493.758523&quot; xlink:href=&quot;#m54e2513f47&quot; y=&quot;169.718125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_18&quot;&gt;
      &lt;!-- 2 --&gt;
      &lt;g transform=&quot;translate(490.577273 184.316562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_10&quot;&gt;
     &lt;g id=&quot;line2d_32&quot;&gt;
      &lt;path clip-path=&quot;url(#p918b795b5b)&quot; d=&quot;M 547.548295 169.718125 
L 547.548295 22.318125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_33&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;547.548295&quot; xlink:href=&quot;#m54e2513f47&quot; y=&quot;169.718125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_19&quot;&gt;
      &lt;!-- 4 --&gt;
      &lt;g transform=&quot;translate(544.367045 184.316562)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-52&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_20&quot;&gt;
     &lt;!-- $x$ --&gt;
     &lt;g transform=&quot;translate(436.96875 197.994687)scale(0.1 -0.1)&quot;&gt;
      &lt;use transform=&quot;translate(0 0.3125)&quot; xlink:href=&quot;#DejaVuSans-Oblique-120&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;matplotlib.axis_4&quot;&gt;
    &lt;g id=&quot;ytick_7&quot;&gt;
     &lt;g id=&quot;line2d_34&quot;&gt;
      &lt;path clip-path=&quot;url(#p918b795b5b)&quot; d=&quot;M 321.63125 163.018125 
L 558.30625 163.018125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_35&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;321.63125&quot; xlink:href=&quot;#m00981eb8d8&quot; y=&quot;163.018125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_21&quot;&gt;
      &lt;!-- 0 --&gt;
      &lt;g transform=&quot;translate(308.26875 166.817344)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_8&quot;&gt;
     &lt;g id=&quot;line2d_36&quot;&gt;
      &lt;path clip-path=&quot;url(#p918b795b5b)&quot; d=&quot;M 321.63125 129.518125 
L 558.30625 129.518125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_37&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;321.63125&quot; xlink:href=&quot;#m00981eb8d8&quot; y=&quot;129.518125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_22&quot;&gt;
      &lt;!-- 1 --&gt;
      &lt;g transform=&quot;translate(308.26875 133.317344)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-49&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_9&quot;&gt;
     &lt;g id=&quot;line2d_38&quot;&gt;
      &lt;path clip-path=&quot;url(#p918b795b5b)&quot; d=&quot;M 321.63125 96.018125 
L 558.30625 96.018125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_39&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;321.63125&quot; xlink:href=&quot;#m00981eb8d8&quot; y=&quot;96.018125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_23&quot;&gt;
      &lt;!-- 2 --&gt;
      &lt;g transform=&quot;translate(308.26875 99.817344)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_10&quot;&gt;
     &lt;g id=&quot;line2d_40&quot;&gt;
      &lt;path clip-path=&quot;url(#p918b795b5b)&quot; d=&quot;M 321.63125 62.518125 
L 558.30625 62.518125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_41&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;321.63125&quot; xlink:href=&quot;#m00981eb8d8&quot; y=&quot;62.518125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_24&quot;&gt;
      &lt;!-- 3 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
&quot; id=&quot;DejaVuSans-51&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(308.26875 66.317344)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-51&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_11&quot;&gt;
     &lt;g id=&quot;line2d_42&quot;&gt;
      &lt;path clip-path=&quot;url(#p918b795b5b)&quot; d=&quot;M 321.63125 29.018125 
L 558.30625 29.018125 
&quot; style=&quot;fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-opacity:0.3;stroke-width:0.8;&quot; /&gt;
     &lt;/g&gt;
     &lt;g id=&quot;line2d_43&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;321.63125&quot; xlink:href=&quot;#m00981eb8d8&quot; y=&quot;29.018125&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_25&quot;&gt;
      &lt;!-- 4 --&gt;
      &lt;g transform=&quot;translate(308.26875 32.817344)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-52&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_26&quot;&gt;
     &lt;!-- $\sigma(x)$ --&gt;
     &lt;g transform=&quot;translate(302.189062 106.068125)rotate(-90)scale(0.1 -0.1)&quot;&gt;
      &lt;use transform=&quot;translate(0 0.125)&quot; xlink:href=&quot;#DejaVuSans-Oblique-963&quot; /&gt;
      &lt;use transform=&quot;translate(63.378906 0.125)&quot; xlink:href=&quot;#DejaVuSans-40&quot; /&gt;
      &lt;use transform=&quot;translate(102.392578 0.125)&quot; xlink:href=&quot;#DejaVuSans-Oblique-120&quot; /&gt;
      &lt;use transform=&quot;translate(161.572266 0.125)&quot; xlink:href=&quot;#DejaVuSans-41&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;line2d_44&quot;&gt;
    &lt;path clip-path=&quot;url(#p918b795b5b)&quot; d=&quot;M 332.389205 163.018125 
L 334.562529 163.018125 
L 336.735853 163.018125 
L 338.909177 163.018125 
L 341.082501 163.018125 
L 343.255825 163.018125 
L 345.429149 163.018125 
L 347.602474 163.018125 
L 349.775798 163.018125 
L 351.949122 163.018125 
L 354.122446 163.018125 
L 356.29577 163.018125 
L 358.469094 163.018125 
L 360.642419 163.018125 
L 362.815743 163.018125 
L 364.989067 163.018125 
L 367.162391 163.018125 
L 369.335715 163.018125 
L 371.509039 163.018125 
L 373.682363 163.018125 
L 375.855688 163.018125 
L 378.029012 163.018125 
L 380.202336 163.018125 
L 382.37566 163.018125 
L 384.548984 163.018125 
L 386.722308 163.018125 
L 388.895632 163.018125 
L 391.068957 163.018125 
L 393.242281 163.018125 
L 395.415605 163.018125 
L 397.588929 163.018125 
L 399.762253 163.018125 
L 401.935577 163.018125 
L 404.108902 163.018125 
L 406.282226 163.018125 
L 408.45555 163.018125 
L 410.628874 163.018125 
L 412.802198 163.018125 
L 414.975522 163.018125 
L 417.148846 163.018125 
L 419.322171 163.018125 
L 421.495495 163.018125 
L 423.668819 163.018125 
L 425.842143 163.018125 
L 428.015467 163.018125 
L 430.188791 163.018125 
L 432.362115 163.018125 
L 434.53544 163.018125 
L 436.708764 163.018125 
L 438.882088 163.018125 
L 441.055412 161.66459 
L 443.228736 158.957519 
L 445.40206 156.250448 
L 447.575385 153.543378 
L 449.748709 150.836307 
L 451.922033 148.129236 
L 454.095357 145.422165 
L 456.268681 142.715095 
L 458.442005 140.008024 
L 460.615329 137.300953 
L 462.788654 134.593883 
L 464.961978 131.886812 
L 467.135302 129.179741 
L 469.308626 126.47267 
L 471.48195 123.7656 
L 473.655274 121.058529 
L 475.828598 118.351458 
L 478.001923 115.644388 
L 480.175247 112.937317 
L 482.348571 110.230246 
L 484.521895 107.523176 
L 486.695219 104.816105 
L 488.868543 102.109034 
L 491.041868 99.401963 
L 493.215192 96.694893 
L 495.388516 93.987822 
L 497.56184 91.280751 
L 499.735164 88.573681 
L 501.908488 85.86661 
L 504.081812 83.159539 
L 506.255137 80.452468 
L 508.428461 77.745398 
L 510.601785 75.038327 
L 512.775109 72.331256 
L 514.948433 69.624186 
L 517.121757 66.917115 
L 519.295081 64.210044 
L 521.468406 61.502973 
L 523.64173 58.795903 
L 525.815054 56.088832 
L 527.988378 53.381761 
L 530.161702 50.674691 
L 532.335026 47.96762 
L 534.508351 45.260549 
L 536.681675 42.553479 
L 538.854999 39.846408 
L 541.028323 37.139337 
L 543.201647 34.432266 
L 545.374971 31.725196 
L 547.548295 29.018125 
&quot; style=&quot;fill:none;stroke:#1f77b4;stroke-linecap:square;stroke-width:1.5;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_8&quot;&gt;
    &lt;path d=&quot;M 321.63125 169.718125 
L 321.63125 22.318125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_9&quot;&gt;
    &lt;path d=&quot;M 558.30625 169.718125 
L 558.30625 22.318125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_10&quot;&gt;
    &lt;path d=&quot;M 321.63125 169.718125 
L 558.30625 169.718125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_11&quot;&gt;
    &lt;path d=&quot;M 321.63125 22.318125 
L 558.30625 22.318125 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_27&quot;&gt;
    &lt;!-- ReLU --&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 44.390625 34.1875 
Q 47.5625 33.109375 50.5625 29.59375 
Q 53.5625 26.078125 56.59375 19.921875 
L 66.609375 0 
L 56 0 
L 46.6875 18.703125 
Q 43.0625 26.03125 39.671875 28.421875 
Q 36.28125 30.8125 30.421875 30.8125 
L 19.671875 30.8125 
L 19.671875 0 
L 9.8125 0 
L 9.8125 72.90625 
L 32.078125 72.90625 
Q 44.578125 72.90625 50.734375 67.671875 
Q 56.890625 62.453125 56.890625 51.90625 
Q 56.890625 45.015625 53.6875 40.46875 
Q 50.484375 35.9375 44.390625 34.1875 
z
M 19.671875 64.796875 
L 19.671875 38.921875 
L 32.078125 38.921875 
Q 39.203125 38.921875 42.84375 42.21875 
Q 46.484375 45.515625 46.484375 51.90625 
Q 46.484375 58.296875 42.84375 61.546875 
Q 39.203125 64.796875 32.078125 64.796875 
z
&quot; id=&quot;DejaVuSans-82&quot; /&gt;
     &lt;path d=&quot;M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
&quot; id=&quot;DejaVuSans-101&quot; /&gt;
     &lt;path d=&quot;M 9.8125 72.90625 
L 19.671875 72.90625 
L 19.671875 8.296875 
L 55.171875 8.296875 
L 55.171875 0 
L 9.8125 0 
z
&quot; id=&quot;DejaVuSans-76&quot; /&gt;
     &lt;path d=&quot;M 8.6875 72.90625 
L 18.609375 72.90625 
L 18.609375 28.609375 
Q 18.609375 16.890625 22.84375 11.734375 
Q 27.09375 6.59375 36.625 6.59375 
Q 46.09375 6.59375 50.34375 11.734375 
Q 54.59375 16.890625 54.59375 28.609375 
L 54.59375 72.90625 
L 64.5 72.90625 
L 64.5 27.390625 
Q 64.5 13.140625 57.4375 5.859375 
Q 50.390625 -1.421875 36.625 -1.421875 
Q 22.796875 -1.421875 15.734375 5.859375 
Q 8.6875 13.140625 8.6875 27.390625 
z
&quot; id=&quot;DejaVuSans-85&quot; /&gt;
    &lt;/defs&gt;
    &lt;g transform=&quot;translate(424.943438 16.318125)scale(0.12 -0.12)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-82&quot; /&gt;
     &lt;use x=&quot;64.982422&quot; xlink:href=&quot;#DejaVuSans-101&quot; /&gt;
     &lt;use x=&quot;126.505859&quot; xlink:href=&quot;#DejaVuSans-76&quot; /&gt;
     &lt;use x=&quot;177.21875&quot; xlink:href=&quot;#DejaVuSans-85&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&quot;p0016c4ec88&quot;&gt;
   &lt;rect height=&quot;147.4&quot; width=&quot;236.675&quot; x=&quot;43.78125&quot; y=&quot;22.318125&quot; /&gt;
  &lt;/clipPath&gt;
  &lt;clipPath id=&quot;p918b795b5b&quot;&gt;
   &lt;rect height=&quot;147.4&quot; width=&quot;236.675&quot; x=&quot;321.63125&quot; y=&quot;22.318125&quot; /&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Neural-Networks&quot;&gt;Neural Networks&lt;a class=&quot;anchor-link&quot; href=&quot;#Neural-Networks&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now that we have our neurons, we can build our neural networks by interconnecting them. This would be a simple of example of such networkNow that we have our neurons, we can build our neural networks by interconnecting them. This is simple of example of such network:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/kvn/neural_net.png&quot; alt=&quot;&quot; title=&quot;Neural Network example. Credit: https://sausheong.github.io/posts/how-to-build-a-simple-artificial-neural-network-with-go/&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This seems a bit more complicated but it's actually the same idea with just more neurons. The &lt;strong&gt;input layer&lt;/strong&gt; is basically a representation of the input values (there are no neurons in the input layer). The &lt;strong&gt;output layer&lt;/strong&gt; are the artifical neurons which produce the final outputs. The &lt;strong&gt;hidden layer&lt;/strong&gt;, basically a layer which is not an input nor an output, is constituted by several neurons. Each neuron has its inputs, its outputs and its activation function. If we talk about parameters, each neuron has a set of weights $w$ (one for each input $i$ it receives) and a bias $b$. We can already see that for this very little example we already have a lot of parameters. This will be important later on.&lt;/p&gt;
&lt;p&gt;This small &lt;em&gt;&quot;brain&quot;&lt;/em&gt; works as following: there are a series of inputs that go to the hidden layer, each neuron in this layer produces an output that becomes an input for the next layer (the output layer in this case) and finally, the output layer neurons produce the final outputs.&lt;/p&gt;
&lt;p&gt;Returning to our original problem, we want to implement one of this Neural Networks inside KVN such that when we give him an image of a number as an input, he will then whisper which number it is as an output.
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;This example is what it is called a feedforward neural network. In these networks, there are no cycles. All information always goes forward from input to output. There are other types of neural networks with different properties, such as recurrent neural networks, but they are more complicated so we will stick to the &quot;easy&quot; case.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;So far, we have defined the &lt;em&gt;mini-brain&lt;/em&gt; we will implement into KVN. In the following parts (coming soon), we will explore how Neural Networks can learn a task and, ultimately, do what we want them to do.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://bepuca.dev/machine%20learning/2020/06/01/kvn-part-2.html&quot;&gt;Part 2&lt;/a&gt;: The training building blocks: loss functions, gradient descent and backpropagation.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://bepuca.dev/machine%20learning/2020/06/13/kvn-part-3.html&quot;&gt;Part 3&lt;/a&gt;: Actual training of a Neural Network to identify handwritten digits.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry></feed>